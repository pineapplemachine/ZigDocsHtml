<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zig Documentation</title>
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNTMgMTQwIj48ZyBmaWxsPSIjRjdBNDFEIj48Zz48cG9seWdvbiBwb2ludHM9IjQ2LDIyIDI4LDQ0IDE5LDMwIi8+PHBvbHlnb24gcG9pbnRzPSI0NiwyMiAzMywzMyAyOCw0NCAyMiw0NCAyMiw5NSAzMSw5NSAyMCwxMDAgMTIsMTE3IDAsMTE3IDAsMjIiIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyIvPjxwb2x5Z29uIHBvaW50cz0iMzEsOTUgMTIsMTE3IDQsMTA2Ii8+PC9nPjxnPjxwb2x5Z29uIHBvaW50cz0iNTYsMjIgNjIsMzYgMzcsNDQiLz48cG9seWdvbiBwb2ludHM9IjU2LDIyIDExMSwyMiAxMTEsNDQgMzcsNDQgNTYsMzIiIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyIvPjxwb2x5Z29uIHBvaW50cz0iMTE2LDk1IDk3LDExNyA5MCwxMDQiLz48cG9seWdvbiBwb2ludHM9IjExNiw5NSAxMDAsMTA0IDk3LDExNyA0MiwxMTcgNDIsOTUiIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyIvPjxwb2x5Z29uIHBvaW50cz0iMTUwLDAgNTIsMTE3IDMsMTQwIDEwMSwyMiIvPjwvZz48Zz48cG9seWdvbiBwb2ludHM9IjE0MSwyMiAxNDAsNDAgMTIyLDQ1Ii8+PHBvbHlnb24gcG9pbnRzPSIxNTMsMjIgMTUzLDExNyAxMDYsMTE3IDEyMCwxMDUgMTI1LDk1IDEzMSw5NSAxMzEsNDUgMTIyLDQ1IDEzMiwzNiAxNDEsMjIiIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyIvPjxwb2x5Z29uIHBvaW50cz0iMTI1LDk1IDEzMCwxMTAgMTA2LDExNyIvPjwvZz48L2c+PC9zdmc+">
    <style type="text/css">
      *, *::before, *::after {
        box-sizing: border-box;
      }
      body {
        font-family: system-ui, -apple-system, Roboto, "Segoe UI", sans-serif;
        font-size: 16px;
        color: #000000;
      }
      .hidden {
        display: none;
      }
      table {
        width: 100%;
      }
      a {
        color: #2A6286;
      }
      details summary {
        cursor: pointer;
      }
      pre {
        font-family: "Source Code Pro",monospace;
        font-size: 1rem;
        background-color: #F5F5F5;
        padding: 1rem;
        margin: 0;
        overflow-x: auto;
      }
      :not(pre) > code {
        white-space: break-spaces;
      }
      code, code a {
        font-family: "Source Code Pro", monospace;
        font-size: 0.9rem;
      }
      code a {
        color: #000000;
      }
      .listFields > div, .listParams > div {
        margin-bottom: 1rem;
      }
      .declHeader a {
        font-size: 0.7rem;
        padding-left: 1rem;
      }
      .declHeader .declHeaderIdentifier {
        padding-left: 0.75rem;
      }
      .fieldDocs {
        border: 1px solid #F5F5F5;
        border-top: 0px;
        padding: 1px 1rem;
      }

      #logo {
        width: 8rem;
        padding: 0.5rem 1rem;
      }

      #navWrap {
        width: -moz-available;
        width: -webkit-fill-available;
        width: stretch;
        margin-left: 11rem;
      }

      #search {
        width: 100%;
      }

      nav {
        width: 10rem;
        float: left;
      }
      nav h2 {
        font-size: 1.2rem;
        text-decoration: underline;
        margin: 0;
        padding: 0.5rem 0;
        text-align: center;
      }
      nav p {
        margin: 0;
        padding: 0;
        text-align: center;
      }
      section {
        clear: both;
        padding-top: 1rem;
      }
      section .declHeader {
        font-size: 1.3rem;
        border-bottom: 1px dashed;
        margin: 0 0;
      }
      section .sectionHeader {
        font-size: 1.3rem;
        margin: 0.5rem 0;
        padding: 0;
        border-bottom: 1px solid;
      }
      #listNav {
        list-style-type: none;
        margin: 0.5rem 0 0 0;
        padding: 0;
        overflow: hidden;
        background-color: #f1f1f1;
      }
      #listNav li {
        float:left;
      }
      #listNav li a {
        display: block;
        color: #000;
        text-align: center;
        padding: .5rem .8rem;
        text-decoration: none;
      }
      #listNav li a:hover {
        background-color: #555;
        color: #fff;
      }
      #listNav li a.active {
        background-color: #FFBB4D;
        color: #000;
      }
      .sectSource {
        margin-bottom: 2rem;
      }

      #helpDialog {
        width: 21rem;
        height: 21rem;
        position: fixed;
        top: 0;
        left: 0;
        background-color: #333;
        color: #fff;
        border: 1px solid #fff;
      }
      #helpDialog h1 {
        text-align: center;
        font-size: 1.5rem;
      }
      #helpDialog dt, #helpDialog dd {
        display: inline;
        margin: 0 0.2rem;
      }
      kbd {
        color: #000;
        background-color: #fafbfc;
        border-color: #d1d5da;
        border-bottom-color: #c6cbd1;
        box-shadow-color: #c6cbd1;
        display: inline-block;
        padding: 0.3rem 0.2rem;
        font: 1.2rem monospace;
        line-height: 0.8rem;
        vertical-align: middle;
        border: solid 1px;
        border-radius: 3px;
        box-shadow: inset 0 -1px 0;
        cursor: default;
      }

      #errors {
        background-color: #faa;
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        max-height: min(20rem, 50vh);
        padding: 0.5rem;
        overflow: auto;
      }
      #errors h1 {
        font-size: 1.5rem;
      }
      #errors pre {
        background-color: #fcc;
      }
      
      .decl .decl {
        padding-left: 1rem;
        border-left: 4px solid;
        border-color: #555;
      }

      .listSearchResults li.selected {
        background-color: #93e196;
      }

      .tableFnErrors dt {
        font-weight: bold;
      }

      dl > div {
          padding: 0.5rem;
          border: 1px solid #c0c0c0;
          margin-top: 0.5rem;
      }

      td, th {
        text-align: unset;
        vertical-align: top;
        margin: 0;
        padding: 0.5rem;
        max-width: 20rem;
        text-overflow: ellipsis;
        overflow-x: hidden;
      }

      ul.columns {
        column-width: 20rem;
      }

      .tok-kw {
          color: #333;
          font-weight: bold;
      }
      .tok-str {
          color: #d14;
      }
      .tok-builtin {
          color: #0086b3;
      }
      .tok-comment {
          color: #777;
          font-style: italic;
      }
      .tok-fn {
          color: #900;
          font-weight: bold;
      }
      .tok-null {
          color: #008080;
      }
      .tok-number {
          color: #008080;
      }
      .tok-type {
          color: #458;
          font-weight: bold;
      }

      @media (prefers-color-scheme: dark) {
        body {
          background-color: #111;
          color: #bbb;
        }
        pre {
          background-color: #222;
          color: #ccc;
        }
        a {
          color: #88f;
        }
        code a {
          color: #ccc;
        }
        .fieldDocs {
          border-color:#2A2A2A;
        }
        #listNav {
          background-color: #333;
        }
        #listNav li a {
          color: #fff;
        }
        #listNav li a:hover {
          background-color: #555;
          color: #fff;
        }
        #listNav li a.active {
          background-color: #FFBB4D;
          color: #000;
        }
        .listSearchResults li.selected {
          background-color: #000;
        }
        .listSearchResults li.selected a {
          color: #fff;
        }
        #errors {
          background-color: #800;
          color: #fff;
        }
        #errors pre {
          background-color: #a00;
          color: #fff;
        }
        dl > div {
          border-color: #373737;
        }
        .tok-kw {
            color: #eee;
        }
        .tok-str {
            color: #2e5;
        }
        .tok-builtin {
            color: #ff894c;
        }
        .tok-comment {
            color: #aa7;
        }
        .tok-fn {
            color: #B1A0F8;
        }
        .tok-null {
            color: #ff8080;
        }
        .tok-number {
            color: #ff8080;
        }
        .tok-type {
            color: #68f;
        }
      }
    </style>
  </head>
  <body>
    <nav>
      <a class="logo" href="#">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 140">
        <g fill="#F7A41D">
          <g>
            <polygon points="46,22 28,44 19,30"/>
            <polygon points="46,22 33,33 28,44 22,44 22,95 31,95 20,100 12,117 0,117 0,22" shape-rendering="crispEdges"/>
            <polygon points="31,95 12,117 4,106"/>
          </g>
          <g>
            <polygon points="56,22 62,36 37,44"/>
            <polygon points="56,22 111,22 111,44 37,44 56,32" shape-rendering="crispEdges"/>
            <polygon points="116,95 97,117 90,104"/>
            <polygon points="116,95 100,104 97,117 42,117 42,95" shape-rendering="crispEdges"/>
            <polygon points="150,0 52,117 3,140 101,22"/>
          </g>
          <g>
            <polygon points="141,22 140,40 122,45"/>
            <polygon points="153,22 153,117 106,117 120,105 125,95 131,95 131,45 122,45 132,36 141,22" shape-rendering="crispEdges"/>
            <polygon points="125,95 130,110 106,117"/>
          </g>
        </g>
        <style>
        #text { fill: #121212 }
        @media (prefers-color-scheme: dark) { #text { fill: #f2f2f2 } }
        </style>
        <g id="text">
          <g>
            <polygon points="260,22 260,37 229,40 177,40 177,22" shape-rendering="crispEdges"/>
            <polygon points="260,37 207,99 207,103 176,103 229,40 229,37"/>
            <polygon points="261,99 261,117 176,117 176,103 206,99" shape-rendering="crispEdges"/>
          </g>
          <rect x="272" y="22" shape-rendering="crispEdges" width="22" height="95"/>
          <g>
            <polygon points="394,67 394,106 376,106 376,81 360,70 346,67" shape-rendering="crispEdges"/>
            <polygon points="360,68 376,81 346,67"/>
            <path d="M394,106c-10.2,7.3-24,12-37.7,12c-29,0-51.1-20.8-51.1-48.3c0-27.3,22.5-48.1,52-48.1    c14.3,0,29.2,5.5,38.9,14l-13,15c-7.1-6.3-16.8-10-25.9-10c-17,0-30.2,12.9-30.2,29.5c0,16.8,13.3,29.6,30.3,29.6    c5.7,0,12.8-2.3,19-5.5L394,106z"/>
          </g>
        </g>
        </svg>
      </a>
    </nav>
    <div id="navWrap">
      <input disabled type="search" id="search" autocomplete="off" spellcheck="false" placeholder="`s` to search, `?` to see more options">
      <div id="sectNav"><ul id="listNav"><li><a href="#" class="">std</a></li><li><a href="std.coff.html" class="active">coff</a></li></ul></div>
    </div>
    <section><div class="decl"><h1 id="std.coff" class="declHeader"><span class="declHeaderCategory">struct</span><span class="declHeaderIdentifier">std.coff</span><a href="#src.zig-std.coff">[src]</a></h1><div class="sectNamespaces"><h2 class="sectionHeader">Namespaces</h2><ul class="listNamespaces columns"><li><a href="std.coff.ImportLookupEntry32.html">std.coff.ImportLookupEntry32</a></li><li><a href="std.coff.ImportLookupEntry64.html">std.coff.ImportLookupEntry64</a></li></ul></div><div class="sectContainers"><h2 class="sectionHeader">Container Types</h2><ul class="listContainers columns"><li><a href="std.coff.CoffHeaderFlags.html">std.coff.CoffHeaderFlags</a></li><li><a href="std.coff.CoffHeader.html">std.coff.CoffHeader</a></li><li><a href="std.coff.DllFlags.html">std.coff.DllFlags</a></li><li><a href="std.coff.Subsystem.html">std.coff.Subsystem</a></li><li><a href="std.coff.OptionalHeader.html">std.coff.OptionalHeader</a></li><li><a href="std.coff.OptionalHeaderPE32.html">std.coff.OptionalHeaderPE32</a></li><li><a href="std.coff.OptionalHeaderPE64.html">std.coff.OptionalHeaderPE64</a></li><li><a href="std.coff.DirectoryEntry.html">std.coff.DirectoryEntry</a></li><li><a href="std.coff.ImageDataDirectory.html">std.coff.ImageDataDirectory</a></li><li><a href="std.coff.BaseRelocationDirectoryEntry.html">std.coff.BaseRelocationDirectoryEntry</a></li><li><a href="std.coff.BaseRelocation.html">std.coff.BaseRelocation</a></li><li><a href="std.coff.BaseRelocationType.html">std.coff.BaseRelocationType</a></li><li><a href="std.coff.DebugDirectoryEntry.html">std.coff.DebugDirectoryEntry</a></li><li><a href="std.coff.DebugType.html">std.coff.DebugType</a></li><li><a href="std.coff.ImportDirectoryEntry.html">std.coff.ImportDirectoryEntry</a></li><li><a href="std.coff.ImportHintNameEntry.html">std.coff.ImportHintNameEntry</a></li><li><a href="std.coff.SectionHeader.html">std.coff.SectionHeader</a></li><li><a href="std.coff.SectionHeaderFlags.html">std.coff.SectionHeaderFlags</a></li><li><a href="std.coff.Symbol.html">std.coff.Symbol</a></li><li><a href="std.coff.SectionNumber.html">std.coff.SectionNumber</a></li><li><a href="std.coff.SymType.html">std.coff.SymType</a></li><li><a href="std.coff.BaseType.html">std.coff.BaseType</a></li><li><a href="std.coff.ComplexType.html">std.coff.ComplexType</a></li><li><a href="std.coff.StorageClass.html">std.coff.StorageClass</a></li><li><a href="std.coff.FunctionDefinition.html">std.coff.FunctionDefinition</a></li><li><a href="std.coff.SectionDefinition.html">std.coff.SectionDefinition</a></li><li><a href="std.coff.FileDefinition.html">std.coff.FileDefinition</a></li><li><a href="std.coff.WeakExternalDefinition.html">std.coff.WeakExternalDefinition</a></li><li><a href="std.coff.WeakExternalFlag.html">std.coff.WeakExternalFlag</a></li><li><a href="std.coff.ComdatSelection.html">std.coff.ComdatSelection</a></li><li><a href="std.coff.DebugInfoDefinition.html">std.coff.DebugInfoDefinition</a></li><li><a href="std.coff.MachineType.html">std.coff.MachineType</a></li><li><a href="std.coff.Coff.html">std.coff.Coff</a></li><li><a href="std.coff.Symtab.html">std.coff.Symtab</a></li><li><a href="std.coff.Strtab.html">std.coff.Strtab</a></li><li><a href="std.coff.ImportHeader.html">std.coff.ImportHeader</a></li><li><a href="std.coff.ImportType.html">std.coff.ImportType</a></li><li><a href="std.coff.ImportNameType.html">std.coff.ImportNameType</a></li><li><a href="std.coff.Relocation.html">std.coff.Relocation</a></li><li><a href="std.coff.ImageRelAmd64.html">std.coff.ImageRelAmd64</a></li><li><a href="std.coff.ImageRelArm64.html">std.coff.ImageRelArm64</a></li></ul></div><div class="sectValues"><h2 class="sectionHeader">Values</h2><div class="listValues"><div class="decl"><h2 id="std.coff.IMAGE_NT_OPTIONAL_HDR32_MAGIC" class="declHeader"><span class="declHeaderCategory">Constant</span><span class="declHeaderIdentifier">IMAGE_NT_OPTIONAL_HDR32_MAGIC</span><a href="#src.zig-std.coff.IMAGE_NT_OPTIONAL_HDR32_MAGIC">[src]</a></h2><div class="sectSource"><h3 class="sectionHeader" id="src.zig-std.coff.IMAGE_NT_OPTIONAL_HDR32_MAGIC">Source Code</h3><details><summary>Source code</summary><pre><code class="sourceText"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> IMAGE_NT_OPTIONAL_HDR32_MAGIC = <span class="tok-number">0x10b</span></code></pre></details></div></div><div class="decl"><h2 id="std.coff.IMAGE_NT_OPTIONAL_HDR64_MAGIC" class="declHeader"><span class="declHeaderCategory">Constant</span><span class="declHeaderIdentifier">IMAGE_NT_OPTIONAL_HDR64_MAGIC</span><a href="#src.zig-std.coff.IMAGE_NT_OPTIONAL_HDR64_MAGIC">[src]</a></h2><div class="sectSource"><h3 class="sectionHeader" id="src.zig-std.coff.IMAGE_NT_OPTIONAL_HDR64_MAGIC">Source Code</h3><details><summary>Source code</summary><pre><code class="sourceText"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> IMAGE_NT_OPTIONAL_HDR64_MAGIC = <span class="tok-number">0x20b</span></code></pre></details></div></div><div class="decl"><h2 id="std.coff.IMAGE_NUMBEROF_DIRECTORY_ENTRIES" class="declHeader"><span class="declHeaderCategory">Constant</span><span class="declHeaderIdentifier">IMAGE_NUMBEROF_DIRECTORY_ENTRIES</span><a href="#src.zig-std.coff.IMAGE_NUMBEROF_DIRECTORY_ENTRIES">[src]</a></h2><div class="sectSource"><h3 class="sectionHeader" id="src.zig-std.coff.IMAGE_NUMBEROF_DIRECTORY_ENTRIES">Source Code</h3><details><summary>Source code</summary><pre><code class="sourceText"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> IMAGE_NUMBEROF_DIRECTORY_ENTRIES = <span class="tok-number">16</span></code></pre></details></div></div></div></div><div class="sectErrSets"><h2 class="sectionHeader">Error Sets</h2><div class="listErrSets"><div class="decl"><h2 id="std.coff.CoffError" class="declHeader"><span class="declHeaderCategory">Error Set</span><span class="declHeaderIdentifier">CoffError</span><a href="#src.zig-std.coff.CoffError">[src]</a></h2><div class="sectFnErrors"><h3 class="sectionHeader">Errors</h3><div class="fnErrorsAnyError"><p><span class="tok-type">anyerror</span> means the error set is known only at runtime.</p></div><div class="tableFnErrors"><dl class="listFnErrors"><div><dt>InvalidMachine</dt></div><div><dt>InvalidPEHeader</dt></div><div><dt>InvalidPEMagic</dt></div><div><dt>MissingCoffSection</dt></div><div><dt>MissingPEHeader</dt></div><div><dt>MissingStringTable</dt></div></dl></div></div><div class="sectSource"><h3 class="sectionHeader" id="src.zig-std.coff.CoffError">Source Code</h3><details><summary>Source code</summary><pre><code class="sourceText"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> CoffError = <span class="tok-kw">error</span>{
    InvalidPEMagic,
    InvalidPEHeader,
    InvalidMachine,
    MissingPEHeader,
    MissingCoffSection,
    MissingStringTable,
}</code></pre></details></div></div></div></div><div class="sectSource"><h2 class="sectionHeader" id="src.zig-std.coff">Source Code</h2><details><summary>Source code</summary><pre><code class="sourceText"><span class="tok-kw">const</span> std = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;std.zig&quot;</span>);
<span class="tok-kw">const</span> assert = <a href="std.html">std</a>.<a href="std.debug.html">debug</a>.<a href="std.debug.html#std.debug.assert">assert</a>;
<span class="tok-kw">const</span> mem = <a href="std.html">std</a>.<a href="std.mem.html">mem</a>;

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> CoffHeaderFlags = <span class="tok-kw">packed</span> <span class="tok-kw">struct</span> {
    <span class="tok-comment">/// Image only, Windows CE, and Microsoft Windows NT and later.</span>
    <span class="tok-comment">/// This indicates that the file does not contain base relocations</span>
    <span class="tok-comment">/// and must therefore be loaded at its preferred base address.</span>
    <span class="tok-comment">/// If the base address is not available, the loader reports an error.</span>
    <span class="tok-comment">/// The default behavior of the linker is to strip base relocations</span>
    <span class="tok-comment">/// from executable (EXE) files.</span>
    RELOCS_STRIPPED: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Image only. This indicates that the image file is valid and can be run.</span>
    <span class="tok-comment">/// If this flag is not set, it indicates a linker error.</span>
    EXECUTABLE_IMAGE: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// COFF line numbers have been removed. This flag is deprecated and should be zero.</span>
    LINE_NUMS_STRIPPED: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// COFF symbol table entries for local symbols have been removed.</span>
    <span class="tok-comment">/// This flag is deprecated and should be zero.</span>
    LOCAL_SYMS_STRIPPED: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Obsolete. Aggressively trim working set.</span>
    <span class="tok-comment">/// This flag is deprecated for Windows 2000 and later and must be zero.</span>
    AGGRESSIVE_WS_TRIM: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Application can handle &gt; 2-GB addresses.</span>
    LARGE_ADDRESS_AWARE: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// This flag is reserved for future use.</span>
    RESERVED: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Little endian: the least significant bit (LSB) precedes the</span>
    <span class="tok-comment">/// most significant bit (MSB) in memory. This flag is deprecated and should be zero.</span>
    BYTES_REVERSED_LO: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Machine is based on a 32-bit-word architecture.</span>
    @&quot;32BIT_MACHINE&quot;: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Debugging information is removed from the image file.</span>
    DEBUG_STRIPPED: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// If the image is on removable media, fully load it and copy it to the swap file.</span>
    REMOVABLE_RUN_FROM_SWAP: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// If the image is on network media, fully load it and copy it to the swap file.</span>
    NET_RUN_FROM_SWAP: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The image file is a system file, not a user program.</span>
    SYSTEM: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The image file is a dynamic-link library (DLL).</span>
    <span class="tok-comment">/// Such files are considered executable files for almost all purposes,</span>
    <span class="tok-comment">/// although they cannot be directly run.</span>
    DLL: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The file should be run only on a uniprocessor machine.</span>
    UP_SYSTEM_ONLY: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Big endian: the MSB precedes the LSB in memory. This flag is deprecated and should be zero.</span>
    BYTES_REVERSED_HI: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> CoffHeader = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    <span class="tok-comment">/// The number that identifies the type of target machine.</span>
    machine: <a href="std.coff.MachineType.html">MachineType</a>,

    <span class="tok-comment">/// The number of sections. This indicates the size of the section table, which immediately follows the headers.</span>
    number_of_sections: <span class="tok-type">u16</span>,

    <span class="tok-comment">/// The low 32 bits of the number of seconds since 00:00 January 1, 1970 (a C run-time time_t value),</span>
    <span class="tok-comment">/// which indicates when the file was created.</span>
    time_date_stamp: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The file offset of the COFF symbol table, or zero if no COFF symbol table is present.</span>
    <span class="tok-comment">/// This value should be zero for an image because COFF debugging information is deprecated.</span>
    pointer_to_symbol_table: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The number of entries in the symbol table.</span>
    <span class="tok-comment">/// This data can be used to locate the string table, which immediately follows the symbol table.</span>
    <span class="tok-comment">/// This value should be zero for an image because COFF debugging information is deprecated.</span>
    number_of_symbols: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The size of the optional header, which is required for executable files but not for object files.</span>
    <span class="tok-comment">/// This value should be zero for an object file. For a description of the header format, see Optional Header (Image Only).</span>
    size_of_optional_header: <span class="tok-type">u16</span>,

    <span class="tok-comment">/// The flags that indicate the attributes of the file.</span>
    flags: <a href="std.coff.CoffHeaderFlags.html">CoffHeaderFlags</a>,
};<span class="tok-comment">

// OptionalHeader.magic values
// see https://msdn.microsoft.com/en-us/library/windows/desktop/ms680339(v=vs.85).aspx
</span><span class="tok-kw">pub</span> <span class="tok-kw">const</span> IMAGE_NT_OPTIONAL_HDR32_MAGIC = <span class="tok-number">0x10b</span>;
<span class="tok-kw">pub</span> <span class="tok-kw">const</span> IMAGE_NT_OPTIONAL_HDR64_MAGIC = <span class="tok-number">0x20b</span>;

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> DllFlags = <span class="tok-kw">packed</span> <span class="tok-kw">struct</span> {
    _reserved_0: <span class="tok-type">u5</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Image can handle a high entropy 64-bit virtual address space.</span>
    HIGH_ENTROPY_VA: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// DLL can be relocated at load time.</span>
    DYNAMIC_BASE: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Code Integrity checks are enforced.</span>
    FORCE_INTEGRITY: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Image is NX compatible.</span>
    NX_COMPAT: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Isolation aware, but do not isolate the image.</span>
    NO_ISOLATION: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Does not use structured exception (SE) handling. No SE handler may be called in this image.</span>
    NO_SEH: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Do not bind the image.</span>
    NO_BIND: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Image must execute in an AppContainer.</span>
    APPCONTAINER: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// A WDM driver.</span>
    WDM_DRIVER: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Image supports Control Flow Guard.</span>
    GUARD_CF: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Terminal Server aware.</span>
    TERMINAL_SERVER_AWARE: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> Subsystem = <span class="tok-kw">enum</span>(<span class="tok-type">u16</span>) {
    <span class="tok-comment">/// An unknown subsystem</span>
    UNKNOWN = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Device drivers and native Windows processes</span>
    NATIVE = <span class="tok-number">1</span>,

    <span class="tok-comment">/// The Windows graphical user interface (GUI) subsystem</span>
    WINDOWS_GUI = <span class="tok-number">2</span>,

    <span class="tok-comment">/// The Windows character subsystem</span>
    WINDOWS_CUI = <span class="tok-number">3</span>,

    <span class="tok-comment">/// The OS/2 character subsystem</span>
    OS2_CUI = <span class="tok-number">5</span>,

    <span class="tok-comment">/// The Posix character subsystem</span>
    POSIX_CUI = <span class="tok-number">7</span>,

    <span class="tok-comment">/// Native Win9x driver</span>
    NATIVE_WINDOWS = <span class="tok-number">8</span>,

    <span class="tok-comment">/// Windows CE</span>
    WINDOWS_CE_GUI = <span class="tok-number">9</span>,

    <span class="tok-comment">/// An Extensible Firmware Interface (EFI) application</span>
    EFI_APPLICATION = <span class="tok-number">10</span>,

    <span class="tok-comment">/// An EFI driver with boot services</span>
    EFI_BOOT_SERVICE_DRIVER = <span class="tok-number">11</span>,

    <span class="tok-comment">/// An EFI driver with run-time services</span>
    EFI_RUNTIME_DRIVER = <span class="tok-number">12</span>,

    <span class="tok-comment">/// An EFI ROM image</span>
    EFI_ROM = <span class="tok-number">13</span>,

    <span class="tok-comment">/// XBOX</span>
    XBOX = <span class="tok-number">14</span>,

    <span class="tok-comment">/// Windows boot application</span>
    WINDOWS_BOOT_APPLICATION = <span class="tok-number">16</span>,

    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> OptionalHeader = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    magic: <span class="tok-type">u16</span>,
    major_linker_version: <span class="tok-type">u8</span>,
    minor_linker_version: <span class="tok-type">u8</span>,
    size_of_code: <span class="tok-type">u32</span>,
    size_of_initialized_data: <span class="tok-type">u32</span>,
    size_of_uninitialized_data: <span class="tok-type">u32</span>,
    address_of_entry_point: <span class="tok-type">u32</span>,
    base_of_code: <span class="tok-type">u32</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> OptionalHeaderPE32 = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    magic: <span class="tok-type">u16</span>,
    major_linker_version: <span class="tok-type">u8</span>,
    minor_linker_version: <span class="tok-type">u8</span>,
    size_of_code: <span class="tok-type">u32</span>,
    size_of_initialized_data: <span class="tok-type">u32</span>,
    size_of_uninitialized_data: <span class="tok-type">u32</span>,
    address_of_entry_point: <span class="tok-type">u32</span>,
    base_of_code: <span class="tok-type">u32</span>,
    base_of_data: <span class="tok-type">u32</span>,
    image_base: <span class="tok-type">u32</span>,
    section_alignment: <span class="tok-type">u32</span>,
    file_alignment: <span class="tok-type">u32</span>,
    major_operating_system_version: <span class="tok-type">u16</span>,
    minor_operating_system_version: <span class="tok-type">u16</span>,
    major_image_version: <span class="tok-type">u16</span>,
    minor_image_version: <span class="tok-type">u16</span>,
    major_subsystem_version: <span class="tok-type">u16</span>,
    minor_subsystem_version: <span class="tok-type">u16</span>,
    win32_version_value: <span class="tok-type">u32</span>,
    size_of_image: <span class="tok-type">u32</span>,
    size_of_headers: <span class="tok-type">u32</span>,
    checksum: <span class="tok-type">u32</span>,
    subsystem: <a href="std.coff.Subsystem.html">Subsystem</a>,
    dll_flags: <a href="std.coff.DllFlags.html">DllFlags</a>,
    size_of_stack_reserve: <span class="tok-type">u32</span>,
    size_of_stack_commit: <span class="tok-type">u32</span>,
    size_of_heap_reserve: <span class="tok-type">u32</span>,
    size_of_heap_commit: <span class="tok-type">u32</span>,
    loader_flags: <span class="tok-type">u32</span>,
    number_of_rva_and_sizes: <span class="tok-type">u32</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> OptionalHeaderPE64 = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    magic: <span class="tok-type">u16</span>,
    major_linker_version: <span class="tok-type">u8</span>,
    minor_linker_version: <span class="tok-type">u8</span>,
    size_of_code: <span class="tok-type">u32</span>,
    size_of_initialized_data: <span class="tok-type">u32</span>,
    size_of_uninitialized_data: <span class="tok-type">u32</span>,
    address_of_entry_point: <span class="tok-type">u32</span>,
    base_of_code: <span class="tok-type">u32</span>,
    image_base: <span class="tok-type">u64</span>,
    section_alignment: <span class="tok-type">u32</span>,
    file_alignment: <span class="tok-type">u32</span>,
    major_operating_system_version: <span class="tok-type">u16</span>,
    minor_operating_system_version: <span class="tok-type">u16</span>,
    major_image_version: <span class="tok-type">u16</span>,
    minor_image_version: <span class="tok-type">u16</span>,
    major_subsystem_version: <span class="tok-type">u16</span>,
    minor_subsystem_version: <span class="tok-type">u16</span>,
    win32_version_value: <span class="tok-type">u32</span>,
    size_of_image: <span class="tok-type">u32</span>,
    size_of_headers: <span class="tok-type">u32</span>,
    checksum: <span class="tok-type">u32</span>,
    subsystem: <a href="std.coff.Subsystem.html">Subsystem</a>,
    dll_flags: <a href="std.coff.DllFlags.html">DllFlags</a>,
    size_of_stack_reserve: <span class="tok-type">u64</span>,
    size_of_stack_commit: <span class="tok-type">u64</span>,
    size_of_heap_reserve: <span class="tok-type">u64</span>,
    size_of_heap_commit: <span class="tok-type">u64</span>,
    loader_flags: <span class="tok-type">u32</span>,
    number_of_rva_and_sizes: <span class="tok-type">u32</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> IMAGE_NUMBEROF_DIRECTORY_ENTRIES = <span class="tok-number">16</span>;

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> DirectoryEntry = <span class="tok-kw">enum</span>(<span class="tok-type">u16</span>) {
    <span class="tok-comment">/// Export Directory</span>
    EXPORT = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Import Directory</span>
    IMPORT = <span class="tok-number">1</span>,

    <span class="tok-comment">/// Resource Directory</span>
    RESOURCE = <span class="tok-number">2</span>,

    <span class="tok-comment">/// Exception Directory</span>
    EXCEPTION = <span class="tok-number">3</span>,

    <span class="tok-comment">/// Security Directory</span>
    SECURITY = <span class="tok-number">4</span>,

    <span class="tok-comment">/// Base Relocation Table</span>
    BASERELOC = <span class="tok-number">5</span>,

    <span class="tok-comment">/// Debug Directory</span>
    DEBUG = <span class="tok-number">6</span>,

    <span class="tok-comment">/// Architecture Specific Data</span>
    ARCHITECTURE = <span class="tok-number">7</span>,

    <span class="tok-comment">/// RVA of GP</span>
    GLOBALPTR = <span class="tok-number">8</span>,

    <span class="tok-comment">/// TLS Directory</span>
    TLS = <span class="tok-number">9</span>,

    <span class="tok-comment">/// Load Configuration Directory</span>
    LOAD_CONFIG = <span class="tok-number">10</span>,

    <span class="tok-comment">/// Bound Import Directory in headers</span>
    BOUND_IMPORT = <span class="tok-number">11</span>,

    <span class="tok-comment">/// Import Address Table</span>
    IAT = <span class="tok-number">12</span>,

    <span class="tok-comment">/// Delay Load Import Descriptors</span>
    DELAY_IMPORT = <span class="tok-number">13</span>,

    <span class="tok-comment">/// COM Runtime descriptor</span>
    COM_DESCRIPTOR = <span class="tok-number">14</span>,

    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ImageDataDirectory = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    virtual_address: <span class="tok-type">u32</span>,
    size: <span class="tok-type">u32</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> BaseRelocationDirectoryEntry = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    <span class="tok-comment">/// The image base plus the page RVA is added to each offset to create the VA where the base relocation must be applied.</span>
    page_rva: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The total number of bytes in the base relocation block, including the Page RVA and Block Size fields and the Type/Offset fields that follow.</span>
    block_size: <span class="tok-type">u32</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> BaseRelocation = <span class="tok-kw">packed</span> <span class="tok-kw">struct</span> {
    <span class="tok-comment">/// Stored in the remaining 12 bits of the WORD, an offset from the starting address that was specified in the Page RVA field for the block.</span>
    <span class="tok-comment">/// This offset specifies where the base relocation is to be applied.</span>
    offset: <span class="tok-type">u12</span>,

    <span class="tok-comment">/// Stored in the high 4 bits of the WORD, a value that indicates the type of base relocation to be applied.</span>
    <span class="tok-type">type</span>: <a href="std.coff.BaseRelocationType.html">BaseRelocationType</a>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> BaseRelocationType = <span class="tok-kw">enum</span>(<span class="tok-type">u4</span>) {
    <span class="tok-comment">/// The base relocation is skipped. This type can be used to pad a block.</span>
    ABSOLUTE = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The base relocation adds the high 16 bits of the difference to the 16-bit field at offset. The 16-bit field represents the high value of a 32-bit word.</span>
    HIGH = <span class="tok-number">1</span>,

    <span class="tok-comment">/// The base relocation adds the low 16 bits of the difference to the 16-bit field at offset. The 16-bit field represents the low half of a 32-bit word.</span>
    LOW = <span class="tok-number">2</span>,

    <span class="tok-comment">/// The base relocation applies all 32 bits of the difference to the 32-bit field at offset.</span>
    HIGHLOW = <span class="tok-number">3</span>,

    <span class="tok-comment">/// The base relocation adds the high 16 bits of the difference to the 16-bit field at offset.</span>
    <span class="tok-comment">/// The 16-bit field represents the high value of a 32-bit word.</span>
    <span class="tok-comment">/// The low 16 bits of the 32-bit value are stored in the 16-bit word that follows this base relocation.</span>
    <span class="tok-comment">/// This means that this base relocation occupies two slots.</span>
    HIGHADJ = <span class="tok-number">4</span>,

    <span class="tok-comment">/// When the machine type is MIPS, the base relocation applies to a MIPS jump instruction.</span>
    MIPS_JMPADDR = <span class="tok-number">5</span>,

    <span class="tok-comment">/// This relocation is meaningful only when the machine type is ARM or Thumb.</span>
    <span class="tok-comment">/// The base relocation applies the 32-bit address of a symbol across a consecutive MOVW/MOVT instruction pair.</span><span class="tok-comment">
    // ARM_MOV32 = 5,

    </span><span class="tok-comment">/// This relocation is only meaningful when the machine type is RISC-V.</span>
    <span class="tok-comment">/// The base relocation applies to the high 20 bits of a 32-bit absolute address.</span><span class="tok-comment">
    // RISCV_HIGH20 = 5,

    </span><span class="tok-comment">/// Reserved, must be zero.</span>
    RESERVED = <span class="tok-number">6</span>,

    <span class="tok-comment">/// This relocation is meaningful only when the machine type is Thumb.</span>
    <span class="tok-comment">/// The base relocation applies the 32-bit address of a symbol to a consecutive MOVW/MOVT instruction pair.</span>
    THUMB_MOV32 = <span class="tok-number">7</span>,

    <span class="tok-comment">/// This relocation is only meaningful when the machine type is RISC-V.</span>
    <span class="tok-comment">/// The base relocation applies to the low 12 bits of a 32-bit absolute address formed in RISC-V I-type instruction format.</span><span class="tok-comment">
    // RISCV_LOW12I = 7,

    </span><span class="tok-comment">/// This relocation is only meaningful when the machine type is RISC-V.</span>
    <span class="tok-comment">/// The base relocation applies to the low 12 bits of a 32-bit absolute address formed in RISC-V S-type instruction format.</span>
    RISCV_LOW12S = <span class="tok-number">8</span>,

    <span class="tok-comment">/// This relocation is only meaningful when the machine type is LoongArch 32-bit.</span>
    <span class="tok-comment">/// The base relocation applies to a 32-bit absolute address formed in two consecutive instructions.</span><span class="tok-comment">
    // LOONGARCH32_MARK_LA = 8,

    </span><span class="tok-comment">/// This relocation is only meaningful when the machine type is LoongArch 64-bit.</span>
    <span class="tok-comment">/// The base relocation applies to a 64-bit absolute address formed in four consecutive instructions.</span><span class="tok-comment">
    // LOONGARCH64_MARK_LA = 8,

    </span><span class="tok-comment">/// The relocation is only meaningful when the machine type is MIPS.</span>
    <span class="tok-comment">/// The base relocation applies to a MIPS16 jump instruction.</span>
    MIPS_JMPADDR16 = <span class="tok-number">9</span>,

    <span class="tok-comment">/// The base relocation applies the difference to the 64-bit field at offset.</span>
    DIR64 = <span class="tok-number">10</span>,

    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> DebugDirectoryEntry = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    characteristics: <span class="tok-type">u32</span>,
    time_date_stamp: <span class="tok-type">u32</span>,
    major_version: <span class="tok-type">u16</span>,
    minor_version: <span class="tok-type">u16</span>,
    <span class="tok-type">type</span>: <a href="std.coff.DebugType.html">DebugType</a>,
    size_of_data: <span class="tok-type">u32</span>,
    address_of_raw_data: <span class="tok-type">u32</span>,
    pointer_to_raw_data: <span class="tok-type">u32</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> DebugType = <span class="tok-kw">enum</span>(<span class="tok-type">u32</span>) {
    UNKNOWN = <span class="tok-number">0</span>,
    COFF = <span class="tok-number">1</span>,
    CODEVIEW = <span class="tok-number">2</span>,
    FPO = <span class="tok-number">3</span>,
    MISC = <span class="tok-number">4</span>,
    EXCEPTION = <span class="tok-number">5</span>,
    FIXUP = <span class="tok-number">6</span>,
    OMAP_TO_SRC = <span class="tok-number">7</span>,
    OMAP_FROM_SRC = <span class="tok-number">8</span>,
    BORLAND = <span class="tok-number">9</span>,
    RESERVED10 = <span class="tok-number">10</span>,
    VC_FEATURE = <span class="tok-number">12</span>,
    POGO = <span class="tok-number">13</span>,
    ILTCG = <span class="tok-number">14</span>,
    MPX = <span class="tok-number">15</span>,
    REPRO = <span class="tok-number">16</span>,
    EX_DLLCHARACTERISTICS = <span class="tok-number">20</span>,

    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ImportDirectoryEntry = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    <span class="tok-comment">/// The RVA of the import lookup table.</span>
    <span class="tok-comment">/// This table contains a name or ordinal for each import.</span>
    <span class="tok-comment">/// (The name &quot;Characteristics&quot; is used in Winnt.h, but no longer describes this field.)</span>
    import_lookup_table_rva: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The stamp that is set to zero until the image is bound.</span>
    <span class="tok-comment">/// After the image is bound, this field is set to the time/data stamp of the DLL.</span>
    time_date_stamp: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The index of the first forwarder reference.</span>
    forwarder_chain: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The address of an ASCII string that contains the name of the DLL.</span>
    <span class="tok-comment">/// This address is relative to the image base.</span>
    name_rva: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The RVA of the import address table.</span>
    <span class="tok-comment">/// The contents of this table are identical to the contents of the import lookup table until the image is bound.</span>
    import_address_table_rva: <span class="tok-type">u32</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ImportLookupEntry32 = <span class="tok-kw">struct</span> {
    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> ByName = <span class="tok-kw">packed</span> <span class="tok-kw">struct</span> {
        name_table_rva: <span class="tok-type">u31</span>,
        flag: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,
    };

    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> ByOrdinal = <span class="tok-kw">packed</span> <span class="tok-kw">struct</span> {
        ordinal_number: <span class="tok-type">u16</span>,
        unused: <span class="tok-type">u15</span> = <span class="tok-number">0</span>,
        flag: <span class="tok-type">u1</span> = <span class="tok-number">1</span>,
    };

    <span class="tok-kw">const</span> mask = <span class="tok-number">0x80000000</span>;

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getImportByName</span>(raw: <span class="tok-type">u32</span>) ?<a href="std.coff.ImportLookupEntry32.ByName.html">ByName</a> {
        <span class="tok-kw">if</span> (<a href="std.coff.ImportLookupEntry32.html#std.coff.ImportLookupEntry32.mask">mask</a> &amp; raw != <span class="tok-number">0</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>;
        <span class="tok-kw">return</span> <span class="tok-builtin">@as</span>(<a href="std.coff.ImportLookupEntry32.ByName.html">ByName</a>, <span class="tok-builtin">@bitCast</span>(raw));
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getImportByOrdinal</span>(raw: <span class="tok-type">u32</span>) ?<a href="std.coff.ImportLookupEntry32.ByOrdinal.html">ByOrdinal</a> {
        <span class="tok-kw">if</span> (<a href="std.coff.ImportLookupEntry32.html#std.coff.ImportLookupEntry32.mask">mask</a> &amp; raw == <span class="tok-number">0</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>;
        <span class="tok-kw">return</span> <span class="tok-builtin">@as</span>(<a href="std.coff.ImportLookupEntry32.ByOrdinal.html">ByOrdinal</a>, <span class="tok-builtin">@bitCast</span>(raw));
    }
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ImportLookupEntry64 = <span class="tok-kw">struct</span> {
    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> ByName = <span class="tok-kw">packed</span> <span class="tok-kw">struct</span> {
        name_table_rva: <span class="tok-type">u31</span>,
        unused: <span class="tok-type">u32</span> = <span class="tok-number">0</span>,
        flag: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,
    };

    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> ByOrdinal = <span class="tok-kw">packed</span> <span class="tok-kw">struct</span> {
        ordinal_number: <span class="tok-type">u16</span>,
        unused: <span class="tok-type">u47</span> = <span class="tok-number">0</span>,
        flag: <span class="tok-type">u1</span> = <span class="tok-number">1</span>,
    };

    <span class="tok-kw">const</span> mask = <span class="tok-number">0x8000000000000000</span>;

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getImportByName</span>(raw: <span class="tok-type">u64</span>) ?<a href="std.coff.ImportLookupEntry64.ByName.html">ByName</a> {
        <span class="tok-kw">if</span> (<a href="std.coff.ImportLookupEntry64.html#std.coff.ImportLookupEntry64.mask">mask</a> &amp; raw != <span class="tok-number">0</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>;
        <span class="tok-kw">return</span> <span class="tok-builtin">@as</span>(<a href="std.coff.ImportLookupEntry64.ByName.html">ByName</a>, <span class="tok-builtin">@bitCast</span>(raw));
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getImportByOrdinal</span>(raw: <span class="tok-type">u64</span>) ?<a href="std.coff.ImportLookupEntry64.ByOrdinal.html">ByOrdinal</a> {
        <span class="tok-kw">if</span> (<a href="std.coff.ImportLookupEntry64.html#std.coff.ImportLookupEntry64.mask">mask</a> &amp; raw == <span class="tok-number">0</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>;
        <span class="tok-kw">return</span> <span class="tok-builtin">@as</span>(<a href="std.coff.ImportLookupEntry64.ByOrdinal.html">ByOrdinal</a>, <span class="tok-builtin">@bitCast</span>(raw));
    }
};

<span class="tok-comment">/// Every name ends with a NULL byte. IF the NULL byte does not fall on</span>
<span class="tok-comment">/// 2byte boundary, the entry structure is padded to ensure 2byte alignment.</span>
<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ImportHintNameEntry = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    <span class="tok-comment">/// An index into the export name pointer table.</span>
    <span class="tok-comment">/// A match is attempted first with this value. If it fails, a binary search is performed on the DLL's export name pointer table.</span>
    hint: <span class="tok-type">u16</span>,

    <span class="tok-comment">/// Pointer to NULL terminated ASCII name.</span>
    <span class="tok-comment">/// Variable length...</span>
    name: [<span class="tok-number">1</span>]<span class="tok-type">u8</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> SectionHeader = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    name: [<span class="tok-number">8</span>]<span class="tok-type">u8</span>,
    virtual_size: <span class="tok-type">u32</span>,
    virtual_address: <span class="tok-type">u32</span>,
    size_of_raw_data: <span class="tok-type">u32</span>,
    pointer_to_raw_data: <span class="tok-type">u32</span>,
    pointer_to_relocations: <span class="tok-type">u32</span>,
    pointer_to_linenumbers: <span class="tok-type">u32</span>,
    number_of_relocations: <span class="tok-type">u16</span>,
    number_of_linenumbers: <span class="tok-type">u16</span>,
    flags: <a href="std.coff.SectionHeaderFlags.html">SectionHeaderFlags</a>,

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getName</span>(self: *<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.SectionHeader.html">SectionHeader</a>) ?[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> {
        <span class="tok-kw">if</span> (self.name[<span class="tok-number">0</span>] == <span class="tok-str">'/'</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>;
        <span class="tok-kw">const</span> len = <a href="std.html">std</a>.<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.indexOfScalar">indexOfScalar</a>(<span class="tok-type">u8</span>, &amp;self.name, <span class="tok-builtin">@as</span>(<span class="tok-type">u8</span>, <span class="tok-number">0</span>)) <span class="tok-kw">orelse</span> self.name.len;
        <span class="tok-kw">return</span> self.name[<span class="tok-number">0</span>..len];
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getNameOffset</span>(self: <a href="std.coff.SectionHeader.html">SectionHeader</a>) ?<span class="tok-type">u32</span> {
        <span class="tok-kw">if</span> (self.name[<span class="tok-number">0</span>] != <span class="tok-str">'/'</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>;
        <span class="tok-kw">const</span> len = <a href="std.html">std</a>.<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.indexOfScalar">indexOfScalar</a>(<span class="tok-type">u8</span>, &amp;self.name, <span class="tok-builtin">@as</span>(<span class="tok-type">u8</span>, <span class="tok-number">0</span>)) <span class="tok-kw">orelse</span> self.name.len;
        <span class="tok-kw">const</span> offset = <a href="std.html">std</a>.<a href="std.fmt.html">fmt</a>.<a href="std.fmt.html#std.fmt.parseInt">parseInt</a>(<span class="tok-type">u32</span>, self.name[<span class="tok-number">1</span>..len], <span class="tok-number">10</span>) <span class="tok-kw">catch</span> <span class="tok-kw">unreachable</span>;
        <span class="tok-kw">return</span> offset;
    }

    <span class="tok-comment">/// Applicable only to section headers in COFF objects.</span>
    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getAlignment</span>(self: <a href="std.coff.SectionHeader.html">SectionHeader</a>) ?<span class="tok-type">u16</span> {
        <span class="tok-kw">if</span> (self.flags.ALIGN == <span class="tok-number">0</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>;
        <span class="tok-kw">return</span> <a href="std.html">std</a>.<a href="std.math.html">math</a>.<a href="std.math.powi.html#std.math.powi.powi">powi</a>(<span class="tok-type">u16</span>, <span class="tok-number">2</span>, self.flags.ALIGN - <span class="tok-number">1</span>) <span class="tok-kw">catch</span> <span class="tok-kw">unreachable</span>;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setAlignment</span>(self: *<a href="std.coff.SectionHeader.html">SectionHeader</a>, new_alignment: <span class="tok-type">u16</span>) <span class="tok-type">void</span> {
        <a href="std.debug.html#std.debug.assert">assert</a>(new_alignment &gt; <span class="tok-number">0</span> <span class="tok-kw">and</span> new_alignment &lt;= <span class="tok-number">8192</span>);
        self.flags.ALIGN = <span class="tok-builtin">@intCast</span>(<a href="std.html">std</a>.<a href="std.math.html">math</a>.<a href="std.math.log2.html#std.math.log2.log2">log2</a>(new_alignment));
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">isCode</span>(self: <a href="std.coff.SectionHeader.html">SectionHeader</a>) <span class="tok-type">bool</span> {
        <span class="tok-kw">return</span> self.flags.CNT_CODE == <span class="tok-number">0b1</span>;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">isComdat</span>(self: <a href="std.coff.SectionHeader.html">SectionHeader</a>) <span class="tok-type">bool</span> {
        <span class="tok-kw">return</span> self.flags.LNK_COMDAT == <span class="tok-number">0b1</span>;
    }
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> SectionHeaderFlags = <span class="tok-kw">packed</span> <span class="tok-kw">struct</span> {
    _reserved_0: <span class="tok-type">u3</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section should not be padded to the next boundary.</span>
    <span class="tok-comment">/// This flag is obsolete and is replaced by IMAGE_SCN_ALIGN_1BYTES.</span>
    <span class="tok-comment">/// This is valid only for object files.</span>
    TYPE_NO_PAD: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    _reserved_1: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section contains executable code.</span>
    CNT_CODE: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section contains initialized data.</span>
    CNT_INITIALIZED_DATA: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section contains uninitialized data.</span>
    CNT_UNINITIALIZED_DATA: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Reserved for future use.</span>
    LNK_OTHER: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section contains comments or other information.</span>
    <span class="tok-comment">/// The .drectve section has this type.</span>
    <span class="tok-comment">/// This is valid for object files only.</span>
    LNK_INFO: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    _reserved_2: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section will not become part of the image.</span>
    <span class="tok-comment">/// This is valid only for object files.</span>
    LNK_REMOVE: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section contains COMDAT data.</span>
    <span class="tok-comment">/// For more information, see COMDAT Sections (Object Only).</span>
    <span class="tok-comment">/// This is valid only for object files.</span>
    LNK_COMDAT: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    _reserved_3: <span class="tok-type">u2</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section contains data referenced through the global pointer (GP).</span>
    GPREL: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Reserved for future use.</span>
    MEM_PURGEABLE: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Reserved for future use.</span>
    MEM_16BIT: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Reserved for future use.</span>
    MEM_LOCKED: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Reserved for future use.</span>
    MEM_PRELOAD: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// Takes on multiple values according to flags:</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_1BYTES: u32 = 0x100000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_2BYTES: u32 = 0x200000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_4BYTES: u32 = 0x300000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_8BYTES: u32 = 0x400000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_16BYTES: u32 = 0x500000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_32BYTES: u32 = 0x600000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_64BYTES: u32 = 0x700000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_128BYTES: u32 = 0x800000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_256BYTES: u32 = 0x900000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_512BYTES: u32 = 0xA00000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_1024BYTES: u32 = 0xB00000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_2048BYTES: u32 = 0xC00000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_4096BYTES: u32 = 0xD00000;</span>
    <span class="tok-comment">/// pub const IMAGE_SCN_ALIGN_8192BYTES: u32 = 0xE00000;</span>
    ALIGN: <span class="tok-type">u4</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section contains extended relocations.</span>
    LNK_NRELOC_OVFL: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section can be discarded as needed.</span>
    MEM_DISCARDABLE: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section cannot be cached.</span>
    MEM_NOT_CACHED: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section is not pageable.</span>
    MEM_NOT_PAGED: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section can be shared in memory.</span>
    MEM_SHARED: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section can be executed as code.</span>
    MEM_EXECUTE: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section can be read.</span>
    MEM_READ: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The section can be written to.</span>
    MEM_WRITE: <span class="tok-type">u1</span> = <span class="tok-number">0</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> Symbol = <span class="tok-kw">struct</span> {
    name: [<span class="tok-number">8</span>]<span class="tok-type">u8</span>,
    value: <span class="tok-type">u32</span>,
    section_number: <a href="std.coff.SectionNumber.html">SectionNumber</a>,
    <span class="tok-type">type</span>: <a href="std.coff.SymType.html">SymType</a>,
    storage_class: <a href="std.coff.StorageClass.html">StorageClass</a>,
    number_of_aux_symbols: <span class="tok-type">u8</span>,

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">sizeOf</span>() <span class="tok-type">usize</span> {
        <span class="tok-kw">return</span> <span class="tok-number">18</span>;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getName</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Symbol.html">Symbol</a>) ?[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> {
        <span class="tok-kw">if</span> (<a href="std.html">std</a>.<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.eql">eql</a>(<span class="tok-type">u8</span>, self.name[<span class="tok-number">0</span>..<span class="tok-number">4</span>], <span class="tok-str">&quot;\x00\x00\x00\x00&quot;</span>)) <span class="tok-kw">return</span> <span class="tok-null">null</span>;
        <span class="tok-kw">const</span> len = <a href="std.html">std</a>.<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.indexOfScalar">indexOfScalar</a>(<span class="tok-type">u8</span>, &amp;self.name, <span class="tok-builtin">@as</span>(<span class="tok-type">u8</span>, <span class="tok-number">0</span>)) <span class="tok-kw">orelse</span> self.name.len;
        <span class="tok-kw">return</span> self.name[<span class="tok-number">0</span>..len];
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getNameOffset</span>(self: <a href="std.coff.Symbol.html">Symbol</a>) ?<span class="tok-type">u32</span> {
        <span class="tok-kw">if</span> (!<a href="std.html">std</a>.<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.eql">eql</a>(<span class="tok-type">u8</span>, self.name[<span class="tok-number">0</span>..<span class="tok-number">4</span>], <span class="tok-str">&quot;\x00\x00\x00\x00&quot;</span>)) <span class="tok-kw">return</span> <span class="tok-null">null</span>;
        <span class="tok-kw">const</span> offset = <a href="std.html">std</a>.<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, self.name[<span class="tok-number">4</span>..<span class="tok-number">8</span>], .little);
        <span class="tok-kw">return</span> offset;
    }
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> SectionNumber = <span class="tok-kw">enum</span>(<span class="tok-type">u16</span>) {
    <span class="tok-comment">/// The symbol record is not yet assigned a section.</span>
    <span class="tok-comment">/// A value of zero indicates that a reference to an external symbol is defined elsewhere.</span>
    <span class="tok-comment">/// A value of non-zero is a common symbol with a size that is specified by the value.</span>
    UNDEFINED = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The symbol has an absolute (non-relocatable) value and is not an address.</span>
    ABSOLUTE = <span class="tok-number">0xffff</span>,

    <span class="tok-comment">/// The symbol provides general type or debugging information but does not correspond to a section.</span>
    <span class="tok-comment">/// Microsoft tools use this setting along with .file records (storage class FILE).</span>
    DEBUG = <span class="tok-number">0xfffe</span>,
    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> SymType = <span class="tok-kw">packed</span> <span class="tok-kw">struct</span> {
    complex_type: <a href="std.coff.ComplexType.html">ComplexType</a>,
    base_type: <a href="std.coff.BaseType.html">BaseType</a>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> BaseType = <span class="tok-kw">enum</span>(<span class="tok-type">u8</span>) {
    <span class="tok-comment">/// No type information or unknown base type. Microsoft tools use this setting</span>
    NULL = <span class="tok-number">0</span>,

    <span class="tok-comment">/// No valid type; used with void pointers and functions</span>
    VOID = <span class="tok-number">1</span>,

    <span class="tok-comment">/// A character (signed byte)</span>
    CHAR = <span class="tok-number">2</span>,

    <span class="tok-comment">/// A 2-byte signed integer</span>
    SHORT = <span class="tok-number">3</span>,

    <span class="tok-comment">/// A natural integer type (normally 4 bytes in Windows)</span>
    INT = <span class="tok-number">4</span>,

    <span class="tok-comment">/// A 4-byte signed integer</span>
    LONG = <span class="tok-number">5</span>,

    <span class="tok-comment">/// A 4-byte floating-point number</span>
    FLOAT = <span class="tok-number">6</span>,

    <span class="tok-comment">/// An 8-byte floating-point number</span>
    DOUBLE = <span class="tok-number">7</span>,

    <span class="tok-comment">/// A structure</span>
    STRUCT = <span class="tok-number">8</span>,

    <span class="tok-comment">/// A union</span>
    UNION = <span class="tok-number">9</span>,

    <span class="tok-comment">/// An enumerated type</span>
    ENUM = <span class="tok-number">10</span>,

    <span class="tok-comment">/// A member of enumeration (a specified value)</span>
    MOE = <span class="tok-number">11</span>,

    <span class="tok-comment">/// A byte; unsigned 1-byte integer</span>
    BYTE = <span class="tok-number">12</span>,

    <span class="tok-comment">/// A word; unsigned 2-byte integer</span>
    WORD = <span class="tok-number">13</span>,

    <span class="tok-comment">/// An unsigned integer of natural size (normally, 4 bytes)</span>
    UINT = <span class="tok-number">14</span>,

    <span class="tok-comment">/// An unsigned 4-byte integer</span>
    DWORD = <span class="tok-number">15</span>,

    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ComplexType = <span class="tok-kw">enum</span>(<span class="tok-type">u8</span>) {
    <span class="tok-comment">/// No derived type; the symbol is a simple scalar variable.</span>
    NULL = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The symbol is a pointer to base type.</span>
    POINTER = <span class="tok-number">16</span>,

    <span class="tok-comment">/// The symbol is a function that returns a base type.</span>
    FUNCTION = <span class="tok-number">32</span>,

    <span class="tok-comment">/// The symbol is an array of base type.</span>
    ARRAY = <span class="tok-number">48</span>,

    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> StorageClass = <span class="tok-kw">enum</span>(<span class="tok-type">u8</span>) {
    <span class="tok-comment">/// A special symbol that represents the end of function, for debugging purposes.</span>
    END_OF_FUNCTION = <span class="tok-number">0xff</span>,

    <span class="tok-comment">/// No assigned storage class.</span>
    NULL = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The automatic (stack) variable. The Value field specifies the stack frame offset.</span>
    AUTOMATIC = <span class="tok-number">1</span>,

    <span class="tok-comment">/// A value that Microsoft tools use for external symbols.</span>
    <span class="tok-comment">/// The Value field indicates the size if the section number is IMAGE_SYM_UNDEFINED (0).</span>
    <span class="tok-comment">/// If the section number is not zero, then the Value field specifies the offset within the section.</span>
    EXTERNAL = <span class="tok-number">2</span>,

    <span class="tok-comment">/// The offset of the symbol within the section.</span>
    <span class="tok-comment">/// If the Value field is zero, then the symbol represents a section name.</span>
    STATIC = <span class="tok-number">3</span>,

    <span class="tok-comment">/// A register variable.</span>
    <span class="tok-comment">/// The Value field specifies the register number.</span>
    REGISTER = <span class="tok-number">4</span>,

    <span class="tok-comment">/// A symbol that is defined externally.</span>
    EXTERNAL_DEF = <span class="tok-number">5</span>,

    <span class="tok-comment">/// A code label that is defined within the module.</span>
    <span class="tok-comment">/// The Value field specifies the offset of the symbol within the section.</span>
    LABEL = <span class="tok-number">6</span>,

    <span class="tok-comment">/// A reference to a code label that is not defined.</span>
    UNDEFINED_LABEL = <span class="tok-number">7</span>,

    <span class="tok-comment">/// The structure member. The Value field specifies the n th member.</span>
    MEMBER_OF_STRUCT = <span class="tok-number">8</span>,

    <span class="tok-comment">/// A formal argument (parameter) of a function. The Value field specifies the n th argument.</span>
    ARGUMENT = <span class="tok-number">9</span>,

    <span class="tok-comment">/// The structure tag-name entry.</span>
    STRUCT_TAG = <span class="tok-number">10</span>,

    <span class="tok-comment">/// A union member. The Value field specifies the n th member.</span>
    MEMBER_OF_UNION = <span class="tok-number">11</span>,

    <span class="tok-comment">/// The Union tag-name entry.</span>
    UNION_TAG = <span class="tok-number">12</span>,

    <span class="tok-comment">/// A Typedef entry.</span>
    TYPE_DEFINITION = <span class="tok-number">13</span>,

    <span class="tok-comment">/// A static data declaration.</span>
    UNDEFINED_STATIC = <span class="tok-number">14</span>,

    <span class="tok-comment">/// An enumerated type tagname entry.</span>
    ENUM_TAG = <span class="tok-number">15</span>,

    <span class="tok-comment">/// A member of an enumeration. The Value field specifies the n th member.</span>
    MEMBER_OF_ENUM = <span class="tok-number">16</span>,

    <span class="tok-comment">/// A register parameter.</span>
    REGISTER_PARAM = <span class="tok-number">17</span>,

    <span class="tok-comment">/// A bit-field reference. The Value field specifies the n th bit in the bit field.</span>
    BIT_FIELD = <span class="tok-number">18</span>,

    <span class="tok-comment">/// A .bb (beginning of block) or .eb (end of block) record.</span>
    <span class="tok-comment">/// The Value field is the relocatable address of the code location.</span>
    BLOCK = <span class="tok-number">100</span>,

    <span class="tok-comment">/// A value that Microsoft tools use for symbol records that define the extent of a function: begin function (.bf ), end function ( .ef ), and lines in function ( .lf ).</span>
    <span class="tok-comment">/// For .lf records, the Value field gives the number of source lines in the function.</span>
    <span class="tok-comment">/// For .ef records, the Value field gives the size of the function code.</span>
    FUNCTION = <span class="tok-number">101</span>,

    <span class="tok-comment">/// An end-of-structure entry.</span>
    END_OF_STRUCT = <span class="tok-number">102</span>,

    <span class="tok-comment">/// A value that Microsoft tools, as well as traditional COFF format, use for the source-file symbol record.</span>
    <span class="tok-comment">/// The symbol is followed by auxiliary records that name the file.</span>
    FILE = <span class="tok-number">103</span>,

    <span class="tok-comment">/// A definition of a section (Microsoft tools use STATIC storage class instead).</span>
    SECTION = <span class="tok-number">104</span>,

    <span class="tok-comment">/// A weak external. For more information, see Auxiliary Format 3: Weak Externals.</span>
    WEAK_EXTERNAL = <span class="tok-number">105</span>,

    <span class="tok-comment">/// A CLR token symbol. The name is an ASCII string that consists of the hexadecimal value of the token.</span>
    <span class="tok-comment">/// For more information, see CLR Token Definition (Object Only).</span>
    CLR_TOKEN = <span class="tok-number">107</span>,

    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> FunctionDefinition = <span class="tok-kw">struct</span> {
    <span class="tok-comment">/// The symbol-table index of the corresponding .bf (begin function) symbol record.</span>
    tag_index: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The size of the executable code for the function itself.</span>
    <span class="tok-comment">/// If the function is in its own section, the SizeOfRawData in the section header is greater or equal to this field,</span>
    <span class="tok-comment">/// depending on alignment considerations.</span>
    total_size: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The file offset of the first COFF line-number entry for the function, or zero if none exists.</span>
    pointer_to_linenumber: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The symbol-table index of the record for the next function.</span>
    <span class="tok-comment">/// If the function is the last in the symbol table, this field is set to zero.</span>
    pointer_to_next_function: <span class="tok-type">u32</span>,

    unused: [<span class="tok-number">2</span>]<span class="tok-type">u8</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> SectionDefinition = <span class="tok-kw">struct</span> {
    <span class="tok-comment">/// The size of section data; the same as SizeOfRawData in the section header.</span>
    length: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// The number of relocation entries for the section.</span>
    number_of_relocations: <span class="tok-type">u16</span>,

    <span class="tok-comment">/// The number of line-number entries for the section.</span>
    number_of_linenumbers: <span class="tok-type">u16</span>,

    <span class="tok-comment">/// The checksum for communal data. It is applicable if the IMAGE_SCN_LNK_COMDAT flag is set in the section header.</span>
    checksum: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// One-based index into the section table for the associated section. This is used when the COMDAT selection setting is 5.</span>
    number: <span class="tok-type">u16</span>,

    <span class="tok-comment">/// The COMDAT selection number. This is applicable if the section is a COMDAT section.</span>
    selection: <a href="std.coff.ComdatSelection.html">ComdatSelection</a>,

    unused: [<span class="tok-number">3</span>]<span class="tok-type">u8</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> FileDefinition = <span class="tok-kw">struct</span> {
    <span class="tok-comment">/// An ANSI string that gives the name of the source file.</span>
    <span class="tok-comment">/// This is padded with nulls if it is less than the maximum length.</span>
    file_name: [<span class="tok-number">18</span>]<span class="tok-type">u8</span>,

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getFileName</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.FileDefinition.html">FileDefinition</a>) []<span class="tok-kw">const</span> <span class="tok-type">u8</span> {
        <span class="tok-kw">const</span> len = <a href="std.html">std</a>.<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.indexOfScalar">indexOfScalar</a>(<span class="tok-type">u8</span>, &amp;self.file_name, <span class="tok-builtin">@as</span>(<span class="tok-type">u8</span>, <span class="tok-number">0</span>)) <span class="tok-kw">orelse</span> self.file_name.len;
        <span class="tok-kw">return</span> self.file_name[<span class="tok-number">0</span>..len];
    }
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> WeakExternalDefinition = <span class="tok-kw">struct</span> {
    <span class="tok-comment">/// The symbol-table index of sym2, the symbol to be linked if sym1 is not found.</span>
    tag_index: <span class="tok-type">u32</span>,

    <span class="tok-comment">/// A value of IMAGE_WEAK_EXTERN_SEARCH_NOLIBRARY indicates that no library search for sym1 should be performed.</span>
    <span class="tok-comment">/// A value of IMAGE_WEAK_EXTERN_SEARCH_LIBRARY indicates that a library search for sym1 should be performed.</span>
    <span class="tok-comment">/// A value of IMAGE_WEAK_EXTERN_SEARCH_ALIAS indicates that sym1 is an alias for sym2.</span>
    flag: <a href="std.coff.WeakExternalFlag.html">WeakExternalFlag</a>,

    unused: [<span class="tok-number">10</span>]<span class="tok-type">u8</span>,
};<span class="tok-comment">

// https://github.com/tpn/winsdk-10/blob/master/Include/10.0.16299.0/km/ntimage.h
</span><span class="tok-kw">pub</span> <span class="tok-kw">const</span> WeakExternalFlag = <span class="tok-kw">enum</span>(<span class="tok-type">u32</span>) {
    SEARCH_NOLIBRARY = <span class="tok-number">1</span>,
    SEARCH_LIBRARY = <span class="tok-number">2</span>,
    SEARCH_ALIAS = <span class="tok-number">3</span>,
    ANTI_DEPENDENCY = <span class="tok-number">4</span>,
    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ComdatSelection = <span class="tok-kw">enum</span>(<span class="tok-type">u8</span>) {
    <span class="tok-comment">/// Not a COMDAT section.</span>
    NONE = <span class="tok-number">0</span>,

    <span class="tok-comment">/// If this symbol is already defined, the linker issues a &quot;multiply defined symbol&quot; error.</span>
    NODUPLICATES = <span class="tok-number">1</span>,

    <span class="tok-comment">/// Any section that defines the same COMDAT symbol can be linked; the rest are removed.</span>
    ANY = <span class="tok-number">2</span>,

    <span class="tok-comment">/// The linker chooses an arbitrary section among the definitions for this symbol.</span>
    <span class="tok-comment">/// If all definitions are not the same size, a &quot;multiply defined symbol&quot; error is issued.</span>
    SAME_SIZE = <span class="tok-number">3</span>,

    <span class="tok-comment">/// The linker chooses an arbitrary section among the definitions for this symbol.</span>
    <span class="tok-comment">/// If all definitions do not match exactly, a &quot;multiply defined symbol&quot; error is issued.</span>
    EXACT_MATCH = <span class="tok-number">4</span>,

    <span class="tok-comment">/// The section is linked if a certain other COMDAT section is linked.</span>
    <span class="tok-comment">/// This other section is indicated by the Number field of the auxiliary symbol record for the section definition.</span>
    <span class="tok-comment">/// This setting is useful for definitions that have components in multiple sections</span>
    <span class="tok-comment">/// (for example, code in one and data in another), but where all must be linked or discarded as a set.</span>
    <span class="tok-comment">/// The other section this section is associated with must be a COMDAT section, which can be another</span>
    <span class="tok-comment">/// associative COMDAT section. An associative COMDAT section's section association chain can't form a loop.</span>
    <span class="tok-comment">/// The section association chain must eventually come to a COMDAT section that doesn't have IMAGE_COMDAT_SELECT_ASSOCIATIVE set.</span>
    ASSOCIATIVE = <span class="tok-number">5</span>,

    <span class="tok-comment">/// The linker chooses the largest definition from among all of the definitions for this symbol.</span>
    <span class="tok-comment">/// If multiple definitions have this size, the choice between them is arbitrary.</span>
    LARGEST = <span class="tok-number">6</span>,

    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> DebugInfoDefinition = <span class="tok-kw">struct</span> {
    unused_1: [<span class="tok-number">4</span>]<span class="tok-type">u8</span>,

    <span class="tok-comment">/// The actual ordinal line number (1, 2, 3, and so on) within the source file, corresponding to the .bf or .ef record.</span>
    linenumber: <span class="tok-type">u16</span>,

    unused_2: [<span class="tok-number">6</span>]<span class="tok-type">u8</span>,

    <span class="tok-comment">/// The symbol-table index of the next .bf symbol record.</span>
    <span class="tok-comment">/// If the function is the last in the symbol table, this field is set to zero.</span>
    <span class="tok-comment">/// It is not used for .ef records.</span>
    pointer_to_next_function: <span class="tok-type">u32</span>,

    unused_3: [<span class="tok-number">2</span>]<span class="tok-type">u8</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> MachineType = <span class="tok-kw">enum</span>(<span class="tok-type">u16</span>) {
    UNKNOWN = <span class="tok-number">0x0</span>,
    <span class="tok-comment">/// Alpha AXP, 32-bit address space</span>
    ALPHA = <span class="tok-number">0x184</span>,
    <span class="tok-comment">/// Alpha 64, 64-bit address space</span>
    ALPHA64 = <span class="tok-number">0x284</span>,
    <span class="tok-comment">/// Matsushita AM33</span>
    AM33 = <span class="tok-number">0x1d3</span>,
    <span class="tok-comment">/// x64</span>
    X64 = <span class="tok-number">0x8664</span>,
    <span class="tok-comment">/// ARM little endian</span>
    ARM = <span class="tok-number">0x1c0</span>,
    <span class="tok-comment">/// ARM64 little endian</span>
    ARM64 = <span class="tok-number">0xaa64</span>,
    <span class="tok-comment">/// ARM64EC</span>
    ARM64EC = <span class="tok-number">0xa641</span>,
    <span class="tok-comment">/// ARM64X</span>
    ARM64X = <span class="tok-number">0xa64e</span>,
    <span class="tok-comment">/// ARM Thumb-2 little endian</span>
    ARMNT = <span class="tok-number">0x1c4</span>,
    <span class="tok-comment">/// CEE</span>
    CEE = <span class="tok-number">0xc0ee</span>,
    <span class="tok-comment">/// CEF</span>
    CEF = <span class="tok-number">0xcef</span>,
    <span class="tok-comment">/// Hybrid PE</span>
    CHPE_X86 = <span class="tok-number">0x3a64</span>,
    <span class="tok-comment">/// EFI byte code</span>
    EBC = <span class="tok-number">0xebc</span>,
    <span class="tok-comment">/// Intel 386 or later processors and compatible processors</span>
    I386 = <span class="tok-number">0x14c</span>,
    <span class="tok-comment">/// Intel Itanium processor family</span>
    IA64 = <span class="tok-number">0x200</span>,
    <span class="tok-comment">/// LoongArch32</span>
    LOONGARCH32 = <span class="tok-number">0x6232</span>,
    <span class="tok-comment">/// LoongArch64</span>
    LOONGARCH64 = <span class="tok-number">0x6264</span>,
    <span class="tok-comment">/// Mitsubishi M32R little endian</span>
    M32R = <span class="tok-number">0x9041</span>,
    <span class="tok-comment">/// MIPS16</span>
    MIPS16 = <span class="tok-number">0x266</span>,
    <span class="tok-comment">/// MIPS with FPU</span>
    MIPSFPU = <span class="tok-number">0x366</span>,
    <span class="tok-comment">/// MIPS16 with FPU</span>
    MIPSFPU16 = <span class="tok-number">0x466</span>,
    <span class="tok-comment">/// Power PC little endian</span>
    POWERPC = <span class="tok-number">0x1f0</span>,
    <span class="tok-comment">/// Power PC with floating point support</span>
    POWERPCFP = <span class="tok-number">0x1f1</span>,
    <span class="tok-comment">/// MIPS little endian</span>
    R3000 = <span class="tok-number">0x162</span>,
    <span class="tok-comment">/// MIPS little endian</span>
    R4000 = <span class="tok-number">0x166</span>,
    <span class="tok-comment">/// MIPS little endian</span>
    R10000 = <span class="tok-number">0x168</span>,
    <span class="tok-comment">/// RISC-V 32-bit address space</span>
    RISCV32 = <span class="tok-number">0x5032</span>,
    <span class="tok-comment">/// RISC-V 64-bit address space</span>
    RISCV64 = <span class="tok-number">0x5064</span>,
    <span class="tok-comment">/// RISC-V 128-bit address space</span>
    RISCV128 = <span class="tok-number">0x5128</span>,
    <span class="tok-comment">/// Hitachi SH3</span>
    SH3 = <span class="tok-number">0x1a2</span>,
    <span class="tok-comment">/// Hitachi SH3 DSP</span>
    SH3DSP = <span class="tok-number">0x1a3</span>,
    <span class="tok-comment">/// SH3E little-endian</span>
    SH3E = <span class="tok-number">0x1a4</span>,
    <span class="tok-comment">/// Hitachi SH4</span>
    SH4 = <span class="tok-number">0x1a6</span>,
    <span class="tok-comment">/// Hitachi SH5</span>
    SH5 = <span class="tok-number">0x1a8</span>,
    <span class="tok-comment">/// Thumb</span>
    THUMB = <span class="tok-number">0x1c2</span>,
    <span class="tok-comment">/// Infineon</span>
    TRICORE = <span class="tok-number">0x520</span>,
    <span class="tok-comment">/// MIPS little-endian WCE v2</span>
    WCEMIPSV2 = <span class="tok-number">0x169</span>,

    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> CoffError = <span class="tok-kw">error</span>{
    InvalidPEMagic,
    InvalidPEHeader,
    InvalidMachine,
    MissingPEHeader,
    MissingCoffSection,
    MissingStringTable,
};<span class="tok-comment">

// Official documentation of the format: https://docs.microsoft.com/en-us/windows/win32/debug/pe-format
</span><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Coff = <span class="tok-kw">struct</span> {
    data: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,<span class="tok-comment">
    // Set if `data` is backed by the image as loaded by the loader
    </span>is_loaded: <span class="tok-type">bool</span>,
    is_image: <span class="tok-type">bool</span>,
    coff_header_offset: <span class="tok-type">usize</span>,

    guid: [<span class="tok-number">16</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>,
    age: <span class="tok-type">u32</span> = <span class="tok-null">undefined</span>,<span class="tok-comment">

    // The lifetime of `data` must be longer than the lifetime of the returned Coff
    </span><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">init</span>(data: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, is_loaded: <span class="tok-type">bool</span>) !<a href="std.coff.Coff.html">Coff</a> {
        <span class="tok-kw">const</span> pe_pointer_offset = <span class="tok-number">0x3C</span>;
        <span class="tok-kw">const</span> pe_magic = <span class="tok-str">&quot;PE\x00\x00&quot;</span>;

        <span class="tok-kw">var</span> stream = <a href="std.html">std</a>.<a href="std.io.html">io</a>.<a href="std.io.fixed_buffer_stream.html#std.io.fixed_buffer_stream.fixedBufferStream">fixedBufferStream</a>(data);
        <span class="tok-kw">const</span> reader = stream.reader();
        <span class="tok-kw">try</span> stream.seekTo(pe_pointer_offset);
        <span class="tok-kw">const</span> coff_header_offset = <span class="tok-kw">try</span> reader.readInt(<span class="tok-type">u32</span>, .little);
        <span class="tok-kw">try</span> stream.seekTo(coff_header_offset);
        <span class="tok-kw">var</span> buf: [<span class="tok-number">4</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;
        <span class="tok-kw">try</span> reader.readNoEof(&amp;buf);
        <span class="tok-kw">const</span> is_image = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.eql">eql</a>(<span class="tok-type">u8</span>, pe_magic, &amp;buf);

        <span class="tok-kw">var</span> coff = <span class="tok-builtin">@This</span>(){
            .data = data,
            .is_image = is_image,
            .is_loaded = is_loaded,
            .coff_header_offset = coff_header_offset,
        };<span class="tok-comment">

        // Do some basic validation upfront
        </span><span class="tok-kw">if</span> (is_image) {
            coff.coff_header_offset = coff.coff_header_offset + <span class="tok-number">4</span>;
            <span class="tok-kw">const</span> coff_header = coff.getCoffHeader();
            <span class="tok-kw">if</span> (coff_header.size_of_optional_header == <span class="tok-number">0</span>) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.MissingPEHeader;
        }<span class="tok-comment">

        // JK: we used to check for architecture here and throw an error if not x86 or derivative.
        // However I am willing to take a leap of faith and let aarch64 have a shot also.

        </span><span class="tok-kw">return</span> coff;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getPdbPath</span>(self: *<a href="std.coff.Coff.html">Coff</a>) !?[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> {
        <a href="std.debug.html#std.debug.assert">assert</a>(self.is_image);

        <span class="tok-kw">const</span> data_dirs = self.getDataDirectories();
        <span class="tok-kw">if</span> (<span class="tok-builtin">@intFromEnum</span>(<a href="std.coff.DirectoryEntry.html">DirectoryEntry</a>.<a href="#">DEBUG</a>) &gt;= data_dirs.len) <span class="tok-kw">return</span> <span class="tok-null">null</span>;

        <span class="tok-kw">const</span> debug_dir = data_dirs[<span class="tok-builtin">@intFromEnum</span>(<a href="std.coff.DirectoryEntry.html">DirectoryEntry</a>.<a href="#">DEBUG</a>)];
        <span class="tok-kw">var</span> stream = <a href="std.html">std</a>.<a href="std.io.html">io</a>.<a href="std.io.fixed_buffer_stream.html#std.io.fixed_buffer_stream.fixedBufferStream">fixedBufferStream</a>(self.data);
        <span class="tok-kw">const</span> reader = stream.reader();

        <span class="tok-kw">if</span> (self.is_loaded) {
            <span class="tok-kw">try</span> stream.seekTo(debug_dir.virtual_address);
        } <span class="tok-kw">else</span> {<span class="tok-comment">
            // Find what section the debug_dir is in, in order to convert the RVA to a file offset
            </span><span class="tok-kw">for</span> (self.getSectionHeaders()) |*sect| {
                <span class="tok-kw">if</span> (debug_dir.virtual_address &gt;= sect.virtual_address <span class="tok-kw">and</span> debug_dir.virtual_address &lt; sect.virtual_address + sect.virtual_size) {
                    <span class="tok-kw">try</span> stream.seekTo(sect.pointer_to_raw_data + (debug_dir.virtual_address - sect.virtual_address));
                    <span class="tok-kw">break</span>;
                }
            } <span class="tok-kw">else</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.InvalidDebugDirectory;
        }<span class="tok-comment">

        // Find the correct DebugDirectoryEntry, and where its data is stored.
        // It can be in any section.
        </span><span class="tok-kw">const</span> debug_dir_entry_count = debug_dir.size / <span class="tok-builtin">@sizeOf</span>(<a href="std.coff.DebugDirectoryEntry.html">DebugDirectoryEntry</a>);
        <span class="tok-kw">var</span> i: <span class="tok-type">u32</span> = <span class="tok-number">0</span>;
        <span class="tok-kw">while</span> (i &lt; debug_dir_entry_count) : (i += <span class="tok-number">1</span>) {
            <span class="tok-kw">const</span> debug_dir_entry = <span class="tok-kw">try</span> reader.readStruct(<a href="std.coff.DebugDirectoryEntry.html">DebugDirectoryEntry</a>);
            <span class="tok-kw">if</span> (debug_dir_entry.<span class="tok-type">type</span> == .CODEVIEW) {
                <span class="tok-kw">const</span> dir_offset = <span class="tok-kw">if</span> (self.is_loaded) debug_dir_entry.address_of_raw_data <span class="tok-kw">else</span> debug_dir_entry.pointer_to_raw_data;
                <span class="tok-kw">try</span> stream.seekTo(dir_offset);
                <span class="tok-kw">break</span>;
            }
        } <span class="tok-kw">else</span> <span class="tok-kw">return</span> <span class="tok-null">null</span>;

        <span class="tok-kw">var</span> cv_signature: [<span class="tok-number">4</span>]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;<span class="tok-comment"> // CodeView signature
        </span><span class="tok-kw">try</span> reader.readNoEof(cv_signature[<span class="tok-number">0</span>..]);<span class="tok-comment">
        // 'RSDS' indicates PDB70 format, used by lld.
        </span><span class="tok-kw">if</span> (!<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.eql">eql</a>(<span class="tok-type">u8</span>, &amp;cv_signature, <span class="tok-str">&quot;RSDS&quot;</span>))
            <span class="tok-kw">return</span> <span class="tok-kw">error</span>.InvalidPEMagic;
        <span class="tok-kw">try</span> reader.readNoEof(self.guid[<span class="tok-number">0</span>..]);
        self.age = <span class="tok-kw">try</span> reader.readInt(<span class="tok-type">u32</span>, .little);<span class="tok-comment">

        // Finally read the null-terminated string.
        </span><span class="tok-kw">const</span> start = reader.context.pos;
        <span class="tok-kw">const</span> len = <a href="std.html">std</a>.<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.indexOfScalar">indexOfScalar</a>(<span class="tok-type">u8</span>, self.data[start..], <span class="tok-number">0</span>) <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-null">null</span>;
        <span class="tok-kw">return</span> self.data[start .. start + len];
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getCoffHeader</span>(self: <a href="std.coff.Coff.html">Coff</a>) <a href="std.coff.CoffHeader.html">CoffHeader</a> {
        <span class="tok-kw">return</span> <span class="tok-builtin">@as</span>(*<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.CoffHeader.html">CoffHeader</a>, <span class="tok-builtin">@ptrCast</span>(self.data[self.coff_header_offset..][<span class="tok-number">0</span>..<span class="tok-builtin">@sizeOf</span>(<a href="std.coff.CoffHeader.html">CoffHeader</a>)])).*;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getOptionalHeader</span>(self: <a href="std.coff.Coff.html">Coff</a>) <a href="std.coff.OptionalHeader.html">OptionalHeader</a> {
        <a href="std.debug.html#std.debug.assert">assert</a>(self.is_image);
        <span class="tok-kw">const</span> offset = self.coff_header_offset + <span class="tok-builtin">@sizeOf</span>(<a href="std.coff.CoffHeader.html">CoffHeader</a>);
        <span class="tok-kw">return</span> <span class="tok-builtin">@as</span>(*<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.OptionalHeader.html">OptionalHeader</a>, <span class="tok-builtin">@ptrCast</span>(self.data[offset..][<span class="tok-number">0</span>..<span class="tok-builtin">@sizeOf</span>(<a href="std.coff.OptionalHeader.html">OptionalHeader</a>)])).*;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getOptionalHeader32</span>(self: <a href="std.coff.Coff.html">Coff</a>) <a href="std.coff.OptionalHeaderPE32.html">OptionalHeaderPE32</a> {
        <a href="std.debug.html#std.debug.assert">assert</a>(self.is_image);
        <span class="tok-kw">const</span> offset = self.coff_header_offset + <span class="tok-builtin">@sizeOf</span>(<a href="std.coff.CoffHeader.html">CoffHeader</a>);
        <span class="tok-kw">return</span> <span class="tok-builtin">@as</span>(*<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.OptionalHeaderPE32.html">OptionalHeaderPE32</a>, <span class="tok-builtin">@ptrCast</span>(self.data[offset..][<span class="tok-number">0</span>..<span class="tok-builtin">@sizeOf</span>(<a href="std.coff.OptionalHeaderPE32.html">OptionalHeaderPE32</a>)])).*;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getOptionalHeader64</span>(self: <a href="std.coff.Coff.html">Coff</a>) <a href="std.coff.OptionalHeaderPE64.html">OptionalHeaderPE64</a> {
        <a href="std.debug.html#std.debug.assert">assert</a>(self.is_image);
        <span class="tok-kw">const</span> offset = self.coff_header_offset + <span class="tok-builtin">@sizeOf</span>(<a href="std.coff.CoffHeader.html">CoffHeader</a>);
        <span class="tok-kw">return</span> <span class="tok-builtin">@as</span>(*<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.OptionalHeaderPE64.html">OptionalHeaderPE64</a>, <span class="tok-builtin">@ptrCast</span>(self.data[offset..][<span class="tok-number">0</span>..<span class="tok-builtin">@sizeOf</span>(<a href="std.coff.OptionalHeaderPE64.html">OptionalHeaderPE64</a>)])).*;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getImageBase</span>(self: <a href="std.coff.Coff.html">Coff</a>) <span class="tok-type">u64</span> {
        <span class="tok-kw">const</span> hdr = self.getOptionalHeader();
        <span class="tok-kw">return</span> <span class="tok-kw">switch</span> (hdr.magic) {
            <a href="std.coff.html#std.coff.IMAGE_NT_OPTIONAL_HDR32_MAGIC">IMAGE_NT_OPTIONAL_HDR32_MAGIC</a> =&gt; self.getOptionalHeader32().image_base,
            <a href="std.coff.html#std.coff.IMAGE_NT_OPTIONAL_HDR64_MAGIC">IMAGE_NT_OPTIONAL_HDR64_MAGIC</a> =&gt; self.getOptionalHeader64().image_base,
            <span class="tok-kw">else</span> =&gt; <span class="tok-kw">unreachable</span>,<span class="tok-comment"> // We assume we have validated the header already
        </span>};
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getNumberOfDataDirectories</span>(self: <a href="std.coff.Coff.html">Coff</a>) <span class="tok-type">u32</span> {
        <span class="tok-kw">const</span> hdr = self.getOptionalHeader();
        <span class="tok-kw">return</span> <span class="tok-kw">switch</span> (hdr.magic) {
            <a href="std.coff.html#std.coff.IMAGE_NT_OPTIONAL_HDR32_MAGIC">IMAGE_NT_OPTIONAL_HDR32_MAGIC</a> =&gt; self.getOptionalHeader32().number_of_rva_and_sizes,
            <a href="std.coff.html#std.coff.IMAGE_NT_OPTIONAL_HDR64_MAGIC">IMAGE_NT_OPTIONAL_HDR64_MAGIC</a> =&gt; self.getOptionalHeader64().number_of_rva_and_sizes,
            <span class="tok-kw">else</span> =&gt; <span class="tok-kw">unreachable</span>,<span class="tok-comment"> // We assume we have validated the header already
        </span>};
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getDataDirectories</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Coff.html">Coff</a>) []<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.ImageDataDirectory.html">ImageDataDirectory</a> {
        <span class="tok-kw">const</span> hdr = self.getOptionalHeader();
        <span class="tok-kw">const</span> size: <span class="tok-type">usize</span> = <span class="tok-kw">switch</span> (hdr.magic) {
            <a href="std.coff.html#std.coff.IMAGE_NT_OPTIONAL_HDR32_MAGIC">IMAGE_NT_OPTIONAL_HDR32_MAGIC</a> =&gt; <span class="tok-builtin">@sizeOf</span>(<a href="std.coff.OptionalHeaderPE32.html">OptionalHeaderPE32</a>),
            <a href="std.coff.html#std.coff.IMAGE_NT_OPTIONAL_HDR64_MAGIC">IMAGE_NT_OPTIONAL_HDR64_MAGIC</a> =&gt; <span class="tok-builtin">@sizeOf</span>(<a href="std.coff.OptionalHeaderPE64.html">OptionalHeaderPE64</a>),
            <span class="tok-kw">else</span> =&gt; <span class="tok-kw">unreachable</span>,<span class="tok-comment"> // We assume we have validated the header already
        </span>};
        <span class="tok-kw">const</span> offset = self.coff_header_offset + <span class="tok-builtin">@sizeOf</span>(<a href="std.coff.CoffHeader.html">CoffHeader</a>) + size;
        <span class="tok-kw">return</span> <span class="tok-builtin">@as</span>([*]<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.ImageDataDirectory.html">ImageDataDirectory</a>, <span class="tok-builtin">@ptrCast</span>(self.data[offset..]))[<span class="tok-number">0</span>..self.getNumberOfDataDirectories()];
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getSymtab</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Coff.html">Coff</a>) ?<a href="std.coff.Symtab.html">Symtab</a> {
        <span class="tok-kw">const</span> coff_header = self.getCoffHeader();
        <span class="tok-kw">if</span> (coff_header.pointer_to_symbol_table == <span class="tok-number">0</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>;

        <span class="tok-kw">const</span> offset = coff_header.pointer_to_symbol_table;
        <span class="tok-kw">const</span> size = coff_header.number_of_symbols * <a href="std.coff.Symbol.html">Symbol</a>.<a href="std.coff.Symbol.html#std.coff.Symbol.sizeOf">sizeOf</a>();
        <span class="tok-kw">return</span> .{ .buffer = self.data[offset..][<span class="tok-number">0</span>..size] };
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getStrtab</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Coff.html">Coff</a>) <span class="tok-kw">error</span>{InvalidStrtabSize}!?<a href="std.coff.Strtab.html">Strtab</a> {
        <span class="tok-kw">const</span> coff_header = self.getCoffHeader();
        <span class="tok-kw">if</span> (coff_header.pointer_to_symbol_table == <span class="tok-number">0</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>;

        <span class="tok-kw">const</span> offset = coff_header.pointer_to_symbol_table + <a href="std.coff.Symbol.html">Symbol</a>.<a href="std.coff.Symbol.html#std.coff.Symbol.sizeOf">sizeOf</a>() * coff_header.number_of_symbols;
        <span class="tok-kw">const</span> size = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, self.data[offset..][<span class="tok-number">0</span>..<span class="tok-number">4</span>], .little);
        <span class="tok-kw">if</span> ((offset + size) &gt; self.data.len) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.InvalidStrtabSize;

        <span class="tok-kw">return</span> <a href="std.coff.Strtab.html">Strtab</a>{ .buffer = self.data[offset..][<span class="tok-number">0</span>..size] };
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">strtabRequired</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Coff.html">Coff</a>) <span class="tok-type">bool</span> {
        <span class="tok-kw">for</span> (self.getSectionHeaders()) |*sect_hdr| <span class="tok-kw">if</span> (sect_hdr.getName() == <span class="tok-null">null</span>) <span class="tok-kw">return</span> <span class="tok-null">true</span>;
        <span class="tok-kw">return</span> <span class="tok-null">false</span>;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getSectionHeaders</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Coff.html">Coff</a>) []<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.SectionHeader.html">SectionHeader</a> {
        <span class="tok-kw">const</span> coff_header = self.getCoffHeader();
        <span class="tok-kw">const</span> offset = self.coff_header_offset + <span class="tok-builtin">@sizeOf</span>(<a href="std.coff.CoffHeader.html">CoffHeader</a>) + coff_header.size_of_optional_header;
        <span class="tok-kw">return</span> <span class="tok-builtin">@as</span>([*]<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.SectionHeader.html">SectionHeader</a>, <span class="tok-builtin">@ptrCast</span>(self.data.ptr + offset))[<span class="tok-number">0</span>..coff_header.number_of_sections];
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getSectionHeadersAlloc</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Coff.html">Coff</a>, allocator: <a href="std.mem.html">mem</a>.<a href="std.mem.Allocator.html">Allocator</a>) ![]<a href="std.coff.SectionHeader.html">SectionHeader</a> {
        <span class="tok-kw">const</span> section_headers = self.getSectionHeaders();
        <span class="tok-kw">const</span> out_buff = <span class="tok-kw">try</span> allocator.alloc(<a href="std.coff.SectionHeader.html">SectionHeader</a>, section_headers.len);
        <span class="tok-kw">for</span> (out_buff, <span class="tok-number">0</span>..) |*section_header, i| {
            section_header.* = section_headers[i];
        }

        <span class="tok-kw">return</span> out_buff;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getSectionName</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Coff.html">Coff</a>, sect_hdr: *<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.SectionHeader.html">SectionHeader</a>) <span class="tok-kw">error</span>{InvalidStrtabSize}![]<span class="tok-kw">const</span> <span class="tok-type">u8</span> {
        <span class="tok-kw">const</span> name = sect_hdr.getName() <span class="tok-kw">orelse</span> blk: {
            <span class="tok-kw">const</span> strtab = (<span class="tok-kw">try</span> self.getStrtab()).?;
            <span class="tok-kw">const</span> name_offset = sect_hdr.getNameOffset().?;
            <span class="tok-kw">break</span> :blk strtab.get(name_offset);
        };
        <span class="tok-kw">return</span> name;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getSectionByName</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Coff.html">Coff</a>, <span class="tok-kw">comptime</span> name: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) ?*<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.SectionHeader.html">SectionHeader</a> {
        <span class="tok-kw">for</span> (self.getSectionHeaders()) |*sect| {
            <span class="tok-kw">const</span> section_name = self.getSectionName(sect) <span class="tok-kw">catch</span> |e| <span class="tok-kw">switch</span> (e) {
                <span class="tok-kw">error</span>.InvalidStrtabSize =&gt; <span class="tok-kw">continue</span>,<span class="tok-comment"> //ignore invalid(?) strtab entries - see also GitHub issue #15238
            </span>};
            <span class="tok-kw">if</span> (<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.eql">eql</a>(<span class="tok-type">u8</span>, section_name, name)) {
                <span class="tok-kw">return</span> sect;
            }
        }
        <span class="tok-kw">return</span> <span class="tok-null">null</span>;
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getSectionData</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Coff.html">Coff</a>, sec: *<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.SectionHeader.html">SectionHeader</a>) []<span class="tok-kw">const</span> <span class="tok-type">u8</span> {
        <span class="tok-kw">const</span> offset = <span class="tok-kw">if</span> (self.is_loaded) sec.virtual_address <span class="tok-kw">else</span> sec.pointer_to_raw_data;
        <span class="tok-kw">return</span> self.data[offset..][<span class="tok-number">0</span>..sec.virtual_size];
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getSectionDataAlloc</span>(self: *<span class="tok-kw">const</span> <a href="std.coff.Coff.html">Coff</a>, sec: *<span class="tok-kw">align</span>(<span class="tok-number">1</span>) <span class="tok-kw">const</span> <a href="std.coff.SectionHeader.html">SectionHeader</a>, allocator: <a href="std.mem.html">mem</a>.<a href="std.mem.Allocator.html">Allocator</a>) ![]<span class="tok-type">u8</span> {
        <span class="tok-kw">const</span> section_data = self.getSectionData(sec);
        <span class="tok-kw">return</span> allocator.dupe(<span class="tok-type">u8</span>, section_data);
    }
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> Symtab = <span class="tok-kw">struct</span> {
    buffer: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">len</span>(self: <a href="std.coff.Symtab.html">Symtab</a>) <span class="tok-type">usize</span> {
        <span class="tok-kw">return</span> <span class="tok-builtin">@divExact</span>(self.buffer.len, <a href="std.coff.Symbol.html">Symbol</a>.<a href="std.coff.Symbol.html#std.coff.Symbol.sizeOf">sizeOf</a>());
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> Tag = <span class="tok-kw">enum</span> {
        symbol,
        debug_info,
        func_def,
        weak_ext,
        file_def,
        sect_def,
    };

    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> Record = <span class="tok-kw">union</span>(Tag) {
        symbol: <a href="std.coff.Symbol.html">Symbol</a>,
        debug_info: <a href="std.coff.DebugInfoDefinition.html">DebugInfoDefinition</a>,
        func_def: <a href="std.coff.FunctionDefinition.html">FunctionDefinition</a>,
        weak_ext: <a href="std.coff.WeakExternalDefinition.html">WeakExternalDefinition</a>,
        file_def: <a href="std.coff.FileDefinition.html">FileDefinition</a>,
        sect_def: <a href="std.coff.SectionDefinition.html">SectionDefinition</a>,
    };

    <span class="tok-comment">/// Lives as long as Symtab instance.</span>
    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">at</span>(self: <a href="std.coff.Symtab.html">Symtab</a>, index: <span class="tok-type">usize</span>, tag: <a href="std.coff.Symtab.Tag.html">Tag</a>) <a href="std.coff.Symtab.Record.html">Record</a> {
        <span class="tok-kw">const</span> offset = index * <a href="std.coff.Symbol.html">Symbol</a>.<a href="std.coff.Symbol.html#std.coff.Symbol.sizeOf">sizeOf</a>();
        <span class="tok-kw">const</span> raw = self.buffer[offset..][<span class="tok-number">0</span>..<a href="std.coff.Symbol.html">Symbol</a>.<a href="std.coff.Symbol.html#std.coff.Symbol.sizeOf">sizeOf</a>()];
        <span class="tok-kw">return</span> <span class="tok-kw">switch</span> (tag) {
            .symbol =&gt; .{ .symbol = <a href="std.coff.Symtab.html#std.coff.Symtab.asSymbol">asSymbol</a>(raw) },
            .debug_info =&gt; .{ .debug_info = <a href="std.coff.Symtab.html#std.coff.Symtab.asDebugInfo">asDebugInfo</a>(raw) },
            .func_def =&gt; .{ .func_def = <a href="std.coff.Symtab.html#std.coff.Symtab.asFuncDef">asFuncDef</a>(raw) },
            .weak_ext =&gt; .{ .weak_ext = <a href="std.coff.Symtab.html#std.coff.Symtab.asWeakExtDef">asWeakExtDef</a>(raw) },
            .file_def =&gt; .{ .file_def = <a href="std.coff.Symtab.html#std.coff.Symtab.asFileDef">asFileDef</a>(raw) },
            .sect_def =&gt; .{ .sect_def = <a href="std.coff.Symtab.html#std.coff.Symtab.asSectDef">asSectDef</a>(raw) },
        };
    }

    <span class="tok-kw">fn</span> <span class="tok-fn">asSymbol</span>(raw: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <a href="std.coff.Symbol.html">Symbol</a> {
        <span class="tok-kw">return</span> .{
            .name = raw[<span class="tok-number">0</span>..<span class="tok-number">8</span>].*,
            .value = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, raw[<span class="tok-number">8</span>..<span class="tok-number">12</span>], .little),
            .section_number = <span class="tok-builtin">@as</span>(<a href="std.coff.SectionNumber.html">SectionNumber</a>, <span class="tok-builtin">@enumFromInt</span>(<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u16</span>, raw[<span class="tok-number">12</span>..<span class="tok-number">14</span>], .little))),
            .<span class="tok-type">type</span> = <span class="tok-builtin">@as</span>(<a href="std.coff.SymType.html">SymType</a>, <span class="tok-builtin">@bitCast</span>(<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u16</span>, raw[<span class="tok-number">14</span>..<span class="tok-number">16</span>], .little))),
            .storage_class = <span class="tok-builtin">@as</span>(<a href="std.coff.StorageClass.html">StorageClass</a>, <span class="tok-builtin">@enumFromInt</span>(raw[<span class="tok-number">16</span>])),
            .number_of_aux_symbols = raw[<span class="tok-number">17</span>],
        };
    }

    <span class="tok-kw">fn</span> <span class="tok-fn">asDebugInfo</span>(raw: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <a href="std.coff.DebugInfoDefinition.html">DebugInfoDefinition</a> {
        <span class="tok-kw">return</span> .{
            .unused_1 = raw[<span class="tok-number">0</span>..<span class="tok-number">4</span>].*,
            .linenumber = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u16</span>, raw[<span class="tok-number">4</span>..<span class="tok-number">6</span>], .little),
            .unused_2 = raw[<span class="tok-number">6</span>..<span class="tok-number">12</span>].*,
            .pointer_to_next_function = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, raw[<span class="tok-number">12</span>..<span class="tok-number">16</span>], .little),
            .unused_3 = raw[<span class="tok-number">16</span>..<span class="tok-number">18</span>].*,
        };
    }

    <span class="tok-kw">fn</span> <span class="tok-fn">asFuncDef</span>(raw: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <a href="std.coff.FunctionDefinition.html">FunctionDefinition</a> {
        <span class="tok-kw">return</span> .{
            .tag_index = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, raw[<span class="tok-number">0</span>..<span class="tok-number">4</span>], .little),
            .total_size = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, raw[<span class="tok-number">4</span>..<span class="tok-number">8</span>], .little),
            .pointer_to_linenumber = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, raw[<span class="tok-number">8</span>..<span class="tok-number">12</span>], .little),
            .pointer_to_next_function = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, raw[<span class="tok-number">12</span>..<span class="tok-number">16</span>], .little),
            .unused = raw[<span class="tok-number">16</span>..<span class="tok-number">18</span>].*,
        };
    }

    <span class="tok-kw">fn</span> <span class="tok-fn">asWeakExtDef</span>(raw: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <a href="std.coff.WeakExternalDefinition.html">WeakExternalDefinition</a> {
        <span class="tok-kw">return</span> .{
            .tag_index = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, raw[<span class="tok-number">0</span>..<span class="tok-number">4</span>], .little),
            .flag = <span class="tok-builtin">@as</span>(<a href="std.coff.WeakExternalFlag.html">WeakExternalFlag</a>, <span class="tok-builtin">@enumFromInt</span>(<a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, raw[<span class="tok-number">4</span>..<span class="tok-number">8</span>], .little))),
            .unused = raw[<span class="tok-number">8</span>..<span class="tok-number">18</span>].*,
        };
    }

    <span class="tok-kw">fn</span> <span class="tok-fn">asFileDef</span>(raw: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <a href="std.coff.FileDefinition.html">FileDefinition</a> {
        <span class="tok-kw">return</span> .{
            .file_name = raw[<span class="tok-number">0</span>..<span class="tok-number">18</span>].*,
        };
    }

    <span class="tok-kw">fn</span> <span class="tok-fn">asSectDef</span>(raw: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <a href="std.coff.SectionDefinition.html">SectionDefinition</a> {
        <span class="tok-kw">return</span> .{
            .length = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, raw[<span class="tok-number">0</span>..<span class="tok-number">4</span>], .little),
            .number_of_relocations = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u16</span>, raw[<span class="tok-number">4</span>..<span class="tok-number">6</span>], .little),
            .number_of_linenumbers = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u16</span>, raw[<span class="tok-number">6</span>..<span class="tok-number">8</span>], .little),
            .checksum = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u32</span>, raw[<span class="tok-number">8</span>..<span class="tok-number">12</span>], .little),
            .number = <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.readInt">readInt</a>(<span class="tok-type">u16</span>, raw[<span class="tok-number">12</span>..<span class="tok-number">14</span>], .little),
            .selection = <span class="tok-builtin">@as</span>(<a href="std.coff.ComdatSelection.html">ComdatSelection</a>, <span class="tok-builtin">@enumFromInt</span>(raw[<span class="tok-number">14</span>])),
            .unused = raw[<span class="tok-number">15</span>..<span class="tok-number">18</span>].*,
        };
    }

    <span class="tok-kw">pub</span> <span class="tok-kw">const</span> Slice = <span class="tok-kw">struct</span> {
        buffer: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,
        num: <span class="tok-type">usize</span>,
        count: <span class="tok-type">usize</span> = <span class="tok-number">0</span>,

        <span class="tok-comment">/// Lives as long as Symtab instance.</span>
        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">next</span>(self: *<a href="std.coff.Symtab.Slice.html">Slice</a>) ?<a href="std.coff.Symbol.html">Symbol</a> {
            <span class="tok-kw">if</span> (self.count &gt;= self.num) <span class="tok-kw">return</span> <span class="tok-null">null</span>;
            <span class="tok-kw">const</span> sym = <a href="std.coff.Symtab.html#std.coff.Symtab.asSymbol">asSymbol</a>(self.buffer[<span class="tok-number">0</span>..<a href="std.coff.Symbol.html">Symbol</a>.<a href="std.coff.Symbol.html#std.coff.Symbol.sizeOf">sizeOf</a>()]);
            self.count += <span class="tok-number">1</span>;
            self.buffer = self.buffer[<a href="std.coff.Symbol.html">Symbol</a>.<a href="std.coff.Symbol.html#std.coff.Symbol.sizeOf">sizeOf</a>()..];
            <span class="tok-kw">return</span> sym;
        }
    };

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">slice</span>(self: <a href="std.coff.Symtab.html">Symtab</a>, start: <span class="tok-type">usize</span>, end: ?<span class="tok-type">usize</span>) <a href="std.coff.Symtab.Slice.html">Slice</a> {
        <span class="tok-kw">const</span> offset = start * <a href="std.coff.Symbol.html">Symbol</a>.<a href="std.coff.Symbol.html#std.coff.Symbol.sizeOf">sizeOf</a>();
        <span class="tok-kw">const</span> llen = <span class="tok-kw">if</span> (end) |e| e * <a href="std.coff.Symbol.html">Symbol</a>.<a href="std.coff.Symbol.html#std.coff.Symbol.sizeOf">sizeOf</a>() <span class="tok-kw">else</span> self.buffer.len;
        <span class="tok-kw">const</span> num = <span class="tok-builtin">@divExact</span>(llen - offset, <a href="std.coff.Symbol.html">Symbol</a>.<a href="std.coff.Symbol.html#std.coff.Symbol.sizeOf">sizeOf</a>());
        <span class="tok-kw">return</span> <a href="std.coff.Symtab.Slice.html">Slice</a>{ .buffer = self.buffer[offset..][<span class="tok-number">0</span>..llen], .num = num };
    }
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> Strtab = <span class="tok-kw">struct</span> {
    buffer: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,

    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">get</span>(self: <a href="std.coff.Strtab.html">Strtab</a>, off: <span class="tok-type">u32</span>) []<span class="tok-kw">const</span> <span class="tok-type">u8</span> {
        <a href="std.debug.html#std.debug.assert">assert</a>(off &lt; self.buffer.len);
        <span class="tok-kw">return</span> <a href="std.mem.html">mem</a>.<a href="std.mem.html#std.mem.sliceTo">sliceTo</a>(<span class="tok-builtin">@as</span>([*:<span class="tok-number">0</span>]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, <span class="tok-builtin">@ptrCast</span>(self.buffer.ptr + off)), <span class="tok-number">0</span>);
    }
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ImportHeader = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    sig1: <a href="std.coff.MachineType.html">MachineType</a>,
    sig2: <span class="tok-type">u16</span>,
    version: <span class="tok-type">u16</span>,
    machine: <a href="std.coff.MachineType.html">MachineType</a>,
    time_date_stamp: <span class="tok-type">u32</span>,
    size_of_data: <span class="tok-type">u32</span>,
    hint: <span class="tok-type">u16</span>,
    types: <span class="tok-kw">packed</span> <span class="tok-kw">struct</span> {
        <span class="tok-type">type</span>: <a href="std.coff.ImportType.html">ImportType</a>,
        name_type: <a href="std.coff.ImportNameType.html">ImportNameType</a>,
        reserved: <span class="tok-type">u11</span>,
    },
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ImportType = <span class="tok-kw">enum</span>(<span class="tok-type">u2</span>) {
    <span class="tok-comment">/// Executable code.</span>
    CODE = <span class="tok-number">0</span>,
    <span class="tok-comment">/// Data.</span>
    DATA = <span class="tok-number">1</span>,
    <span class="tok-comment">/// Specified as CONST in .def file.</span>
    CONST = <span class="tok-number">2</span>,
    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ImportNameType = <span class="tok-kw">enum</span>(<span class="tok-type">u3</span>) {
    <span class="tok-comment">/// The import is by ordinal. This indicates that the value in the Ordinal/Hint</span>
    <span class="tok-comment">/// field of the import header is the import's ordinal. If this constant is not</span>
    <span class="tok-comment">/// specified, then the Ordinal/Hint field should always be interpreted as the import's hint.</span>
    ORDINAL = <span class="tok-number">0</span>,
    <span class="tok-comment">/// The import name is identical to the public symbol name.</span>
    NAME = <span class="tok-number">1</span>,
    <span class="tok-comment">/// The import name is the public symbol name, but skipping the leading ?, @, or optionally _.</span>
    NAME_NOPREFIX = <span class="tok-number">2</span>,
    <span class="tok-comment">/// The import name is the public symbol name, but skipping the leading ?, @, or optionally _,</span>
    <span class="tok-comment">/// and truncating at the first @.</span>
    NAME_UNDECORATE = <span class="tok-number">3</span>,
    <span class="tok-comment">/// https://github.com/llvm/llvm-project/pull/83211</span>
    NAME_EXPORTAS = <span class="tok-number">4</span>,
    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> Relocation = <span class="tok-kw">extern</span> <span class="tok-kw">struct</span> {
    virtual_address: <span class="tok-type">u32</span>,
    symbol_table_index: <span class="tok-type">u32</span>,
    <span class="tok-type">type</span>: <span class="tok-type">u16</span>,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ImageRelAmd64 = <span class="tok-kw">enum</span>(<span class="tok-type">u16</span>) {
    <span class="tok-comment">/// The relocation is ignored.</span>
    absolute = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The 64-bit VA of the relocation target.</span>
    addr64 = <span class="tok-number">1</span>,

    <span class="tok-comment">/// The 32-bit VA of the relocation target.</span>
    addr32 = <span class="tok-number">2</span>,

    <span class="tok-comment">/// The 32-bit address without an image base.</span>
    addr32nb = <span class="tok-number">3</span>,

    <span class="tok-comment">/// The 32-bit relative address from the byte following the relocation.</span>
    rel32 = <span class="tok-number">4</span>,

    <span class="tok-comment">/// The 32-bit address relative to byte distance 1 from the relocation.</span>
    rel32_1 = <span class="tok-number">5</span>,

    <span class="tok-comment">/// The 32-bit address relative to byte distance 2 from the relocation.</span>
    rel32_2 = <span class="tok-number">6</span>,

    <span class="tok-comment">/// The 32-bit address relative to byte distance 3 from the relocation.</span>
    rel32_3 = <span class="tok-number">7</span>,

    <span class="tok-comment">/// The 32-bit address relative to byte distance 4 from the relocation.</span>
    rel32_4 = <span class="tok-number">8</span>,

    <span class="tok-comment">/// The 32-bit address relative to byte distance 5 from the relocation.</span>
    rel32_5 = <span class="tok-number">9</span>,

    <span class="tok-comment">/// The 16-bit section index of the section that contains the target.</span>
    <span class="tok-comment">/// This is used to support debugging information.</span>
    section = <span class="tok-number">10</span>,

    <span class="tok-comment">/// The 32-bit offset of the target from the beginning of its section.</span>
    <span class="tok-comment">/// This is used to support debugging information and static thread local storage.</span>
    secrel = <span class="tok-number">11</span>,

    <span class="tok-comment">/// A 7-bit unsigned offset from the base of the section that contains the target.</span>
    secrel7 = <span class="tok-number">12</span>,

    <span class="tok-comment">/// CLR tokens.</span>
    token = <span class="tok-number">13</span>,

    <span class="tok-comment">/// A 32-bit signed span-dependent value emitted into the object.</span>
    srel32 = <span class="tok-number">14</span>,

    <span class="tok-comment">/// A pair that must immediately follow every span-dependent value.</span>
    pair = <span class="tok-number">15</span>,

    <span class="tok-comment">/// A 32-bit signed span-dependent value that is applied at link time.</span>
    sspan32 = <span class="tok-number">16</span>,

    _,
};

<span class="tok-kw">pub</span> <span class="tok-kw">const</span> ImageRelArm64 = <span class="tok-kw">enum</span>(<span class="tok-type">u16</span>) {
    <span class="tok-comment">/// The relocation is ignored.</span>
    absolute = <span class="tok-number">0</span>,

    <span class="tok-comment">/// The 32-bit VA of the target.</span>
    addr32 = <span class="tok-number">1</span>,

    <span class="tok-comment">/// The 32-bit RVA of the target.</span>
    addr32nb = <span class="tok-number">2</span>,

    <span class="tok-comment">/// The 26-bit relative displacement to the target, for B and BL instructions.</span>
    branch26 = <span class="tok-number">3</span>,

    <span class="tok-comment">/// The page base of the target, for ADRP instruction.</span>
    pagebase_rel21 = <span class="tok-number">4</span>,

    <span class="tok-comment">/// The 21-bit relative displacement to the target, for instruction ADR.</span>
    rel21 = <span class="tok-number">5</span>,

    <span class="tok-comment">/// The 12-bit page offset of the target, for instructions ADD/ADDS (immediate) with zero shift.</span>
    pageoffset_12a = <span class="tok-number">6</span>,

    <span class="tok-comment">/// The 12-bit page offset of the target, for instruction LDR (indexed, unsigned immediate).</span>
    pageoffset_12l = <span class="tok-number">7</span>,

    <span class="tok-comment">/// The 32-bit offset of the target from the beginning of its section.</span>
    <span class="tok-comment">/// This is used to support debugging information and static thread local storage.</span>
    secrel = <span class="tok-number">8</span>,

    <span class="tok-comment">/// Bit 0:11 of section offset of the target for instructions ADD/ADDS (immediate) with zero shift.</span>
    low12a = <span class="tok-number">9</span>,

    <span class="tok-comment">/// Bit 12:23 of section offset of the target, for instructions ADD/ADDS (immediate) with zero shift.</span>
    high12a = <span class="tok-number">10</span>,

    <span class="tok-comment">/// Bit 0:11 of section offset of the target, for instruction LDR (indexed, unsigned immediate).</span>
    low12l = <span class="tok-number">11</span>,

    <span class="tok-comment">/// CLR token.</span>
    token = <span class="tok-number">12</span>,

    <span class="tok-comment">/// The 16-bit section index of the section that contains the target.</span>
    <span class="tok-comment">/// This is used to support debugging information.</span>
    section = <span class="tok-number">13</span>,

    <span class="tok-comment">/// The 64-bit VA of the relocation target.</span>
    addr64 = <span class="tok-number">14</span>,

    <span class="tok-comment">/// The 19-bit offset to the relocation target, for conditional B instruction.</span>
    branch19 = <span class="tok-number">15</span>,

    <span class="tok-comment">/// The 14-bit offset to the relocation target, for instructions TBZ and TBNZ.</span>
    branch14 = <span class="tok-number">16</span>,

    <span class="tok-comment">/// The 32-bit relative address from the byte following the relocation.</span>
    rel32 = <span class="tok-number">17</span>,

    _,
};</code></pre></details></div></div></section>
    <div class="sectSearchResults hidden">
      <h2>Search Results</h2>
      <ul class="listSearchResults"></ul>
    </div>
    <div class="sectSearchNoResults hidden">
      <h2>No Results Found</h2>
      <p>Press escape to exit search and then '?' to see more options.</p>
    </div>
    <div id="helpDialog" class="hidden">
      <h1>Keyboard Shortcuts</h1>
      <dl><dt><kbd>?</kbd></dt><dd>Show this help dialog</dd></dl>
      <dl><dt><kbd>Esc</kbd></dt><dd>Clear focus; close this dialog</dd></dl>
      <dl><dt><kbd>s</kbd></dt><dd>Focus the search field</dd></dl>
      <dl><dt><kbd>u</kbd></dt><dd>Go to source code</dd></dl>
      <dl><dt><kbd></kbd></dt><dd>Move up in search results</dd></dl>
      <dl><dt><kbd></kbd></dt><dd>Move down in search results</dd></dl>
      <dl><dt><kbd></kbd></dt><dd>Go to active search result</dd></dl>
    </div>
    <div id="errors" class="hidden">
      <h1>Errors</h1>
      <pre id="errorsText"></pre>
    </div>
    <script src="main.js"></script>
  </body>
</html>
